

<!DOCTYPE html>
<html class="writer-html5" lang="es" data-content_root="../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>exporters &mdash; documentación de Code Empathizer - 2.0.0</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=ea25ecff"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/translations.js?v=f85f4cfb"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Índice" href="../genindex.html" />
    <link rel="search" title="Búsqueda" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Code Empathizer
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Buscar documentos" aria-label="Buscar documentos" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contenidos:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Módulos de Code Empathizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API de Code Empathizer</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Code Empathizer</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Código de módulo</a></li>
      <li class="breadcrumb-item active">exporters</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Código fuente para exporters</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Módulo de exportación de resultados.</span>

<span class="sd">Este módulo es parte de Code Empathizer, una herramienta para medir la alineación</span>
<span class="sd">entre el código de una empresa y sus candidatos.</span>

<span class="sd">Autor: https://github.com/686f6c61</span>
<span class="sd">Repositorio: https://github.com/686f6c61/Code-Empathizer</span>
<span class="sd">Fecha: Noviembre 2025</span>
<span class="sd">Licencia: MIT</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">List</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">zipfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">base64</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jinja2</span><span class="w"> </span><span class="kn">import</span> <span class="n">Environment</span><span class="p">,</span> <span class="n">FileSystemLoader</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<div class="viewcode-block" id="Exporter">
<a class="viewcode-back" href="../api/exporters.html#exporters.Exporter">[documentos]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Exporter</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gestor de exportación de resultados en múltiples formatos.</span>
<span class="sd">    </span>
<span class="sd">    Soporta exportación a texto plano, JSON y HTML con plantillas</span>
<span class="sd">    personalizadas para visualización interactiva.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="Exporter.format_date">
<a class="viewcode-back" href="../api/exporters.html#exporters.Exporter.format_date">[documentos]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">format_date</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filtro Jinja2 para formatear fechas.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            value: Fecha en formato ISO string o datetime object.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            str: Fecha formateada como DD/MM/YYYY HH:MM:SS.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;+00:00&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">date</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">return</span> <span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">/%m/%Y %H:%M:%S&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value</span></div>


<div class="viewcode-block" id="Exporter.exportar_txt">
<a class="viewcode-back" href="../api/exporters.html#exporters.Exporter.exportar_txt">[documentos]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">exportar_txt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metricas</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">timestamp</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exporta los resultados a archivo de texto plano.</span>
<span class="sd">        </span>
<span class="sd">        Genera un informe detallado con formato de tabla que incluye:</span>
<span class="sd">        - Información de repositorios</span>
<span class="sd">        - Puntuación de empatía</span>
<span class="sd">        - Métricas por categoría</span>
<span class="sd">        - Recomendaciones</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            metricas: Diccionario con los resultados del análisis.</span>
<span class="sd">            timestamp: Marca de tiempo para el nombre del archivo.</span>
<span class="sd">        </span>
<span class="sd">        Raises:</span>
<span class="sd">            IOError: Si no se puede escribir el archivo.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s1">&#39;export&#39;</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">output_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;export/reporte_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s1">.txt&#39;</span>
            
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="c1"># Encabezado</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">80</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;ANÁLISIS DE EMPATÍA EMPRESA-CANDIDATO</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">80</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fecha de generación: </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/%m/%Y %H:%M:%S&#39;</span><span class="p">)</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="c1"># Verificar estructura de métricas</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">metricas</span> <span class="ow">or</span> <span class="s1">&#39;repos&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">metricas</span><span class="p">:</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;ERROR: No hay datos para analizar</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">return</span>

                <span class="c1"># Información de repositorios</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">80</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;RESUMEN DE REPOSITORIOS</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">80</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">repo_tipo</span><span class="p">,</span> <span class="n">repo_data</span> <span class="ow">in</span> <span class="n">metricas</span><span class="p">[</span><span class="s1">&#39;repos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">repo_data</span><span class="p">:</span>
                        <span class="k">continue</span>
                        
                    <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;EMPRESA (Master)&quot;</span> <span class="k">if</span> <span class="n">repo_tipo</span> <span class="o">==</span> <span class="s2">&quot;empresa&quot;</span> <span class="k">else</span> <span class="s2">&quot;CANDIDATO&quot;</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    
                    <span class="c1"># Metadata</span>
                    <span class="n">meta</span> <span class="o">=</span> <span class="n">repo_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;metadata&#39;</span><span class="p">,</span> <span class="p">{})</span>
                    <span class="k">if</span> <span class="n">meta</span><span class="p">:</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;• Repositorio: </span><span class="si">{</span><span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nombre&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;• URL: </span><span class="si">{</span><span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;url&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;• Descripción: </span><span class="si">{</span><span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;descripcion&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;• Lenguaje principal: </span><span class="si">{</span><span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;lenguaje_principal&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="s1">&#39;lenguajes_analizados&#39;</span> <span class="ow">in</span> <span class="n">meta</span><span class="p">:</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;• Lenguajes analizados: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;lenguajes_analizados&#39;</span><span class="p">])</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;• Archivos analizados: </span><span class="si">{</span><span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;archivos_analizados&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;• Tamaño: </span><span class="si">{</span><span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tamano_kb&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="s2"> KB</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="c1"># Análisis de empatía si existe</span>
                <span class="k">if</span> <span class="s1">&#39;empathy_analysis&#39;</span> <span class="ow">in</span> <span class="n">metricas</span><span class="p">:</span>
                    <span class="n">analysis</span> <span class="o">=</span> <span class="n">metricas</span><span class="p">[</span><span class="s1">&#39;empathy_analysis&#39;</span><span class="p">]</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">80</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;RESULTADO DEL ANÁLISIS DE EMPATÍA</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">80</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    
                    <span class="c1"># Puntuación principal</span>
                    <span class="n">score</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;empathy_score&#39;</span><span class="p">]</span>
                    <span class="n">interpretation</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;interpretation&#39;</span><span class="p">]</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PUNTUACIÓN DE EMPATÍA: </span><span class="si">{</span><span class="n">score</span><span class="si">}</span><span class="s2">%</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Nivel: </span><span class="si">{</span><span class="n">interpretation</span><span class="p">[</span><span class="s1">&#39;level&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   </span><span class="si">{</span><span class="n">interpretation</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Recomendación: </span><span class="si">{</span><span class="n">interpretation</span><span class="p">[</span><span class="s1">&#39;recommendation&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    
                    <span class="c1"># Puntuaciones por categoría</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Puntuaciones por Categoría:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">40</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">categoria</span><span class="p">,</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;category_scores&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="n">indicador</span> <span class="o">=</span> <span class="s2">&quot;[EXCELENTE]&quot;</span> <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;=</span> <span class="mi">80</span> <span class="k">else</span> <span class="s2">&quot;[BUENO]&quot;</span> <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;=</span> <span class="mi">60</span> <span class="k">else</span> <span class="s2">&quot;[MEJORAR]&quot;</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  • </span><span class="si">{</span><span class="n">categoria</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">% </span><span class="si">{</span><span class="n">indicador</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    
                    <span class="c1"># Coincidencia de lenguajes</span>
                    <span class="n">lang_overlap</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;language_overlap&#39;</span><span class="p">]</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Coincidencia de Lenguajes: </span><span class="si">{</span><span class="n">lang_overlap</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">lang_overlap</span><span class="p">[</span><span class="s1">&#39;missing&#39;</span><span class="p">]:</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ADVERTENCIA: Lenguajes faltantes del candidato: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lang_overlap</span><span class="p">[</span><span class="s1">&#39;missing&#39;</span><span class="p">])</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    
                    <span class="c1"># Recomendaciones</span>
                    <span class="k">if</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;recommendations&#39;</span><span class="p">]:</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Recomendaciones para el Candidato:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">40</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">rec</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;recommendations&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">):</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">rec</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   </span><span class="si">{</span><span class="n">rec</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                            <span class="k">if</span> <span class="s1">&#39;tips&#39;</span> <span class="ow">in</span> <span class="n">rec</span><span class="p">:</span>
                                <span class="k">for</span> <span class="n">tip</span> <span class="ow">in</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;tips&#39;</span><span class="p">]:</span>
                                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   - </span><span class="si">{</span><span class="n">tip</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                
                <span class="c1"># Análisis comparativo detallado por categoría</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">80</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;MÉTRICAS DETALLADAS POR CATEGORÍA</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">80</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="n">categorias</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s2">&quot;nombres&quot;</span><span class="p">,</span> <span class="s2">&quot;documentacion&quot;</span><span class="p">,</span> <span class="s2">&quot;modularidad&quot;</span><span class="p">,</span> <span class="s2">&quot;complejidad&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;manejo_errores&quot;</span><span class="p">,</span> <span class="s2">&quot;pruebas&quot;</span><span class="p">,</span> <span class="s2">&quot;consistencia_estilo&quot;</span><span class="p">,</span> <span class="s2">&quot;seguridad&quot;</span>
                <span class="p">]</span>

                <span class="k">for</span> <span class="n">categoria</span> <span class="ow">in</span> <span class="n">categorias</span><span class="p">:</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">categoria</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">categoria</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    
                    <span class="c1"># Tabla comparativa</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;┌&quot;</span> <span class="o">+</span> <span class="s2">&quot;─&quot;</span> <span class="o">*</span> <span class="mi">30</span> <span class="o">+</span> <span class="s2">&quot;┬&quot;</span> <span class="o">+</span> <span class="s2">&quot;─&quot;</span> <span class="o">*</span> <span class="mi">15</span> <span class="o">+</span> <span class="s2">&quot;┬&quot;</span> <span class="o">+</span> <span class="s2">&quot;─&quot;</span> <span class="o">*</span> <span class="mi">15</span> <span class="o">+</span> <span class="s2">&quot;┐</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;│ Métrica&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">23</span> <span class="o">+</span> <span class="s2">&quot;│ Empresa&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">7</span> <span class="o">+</span> <span class="s2">&quot;│ Candidato&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">+</span> <span class="s2">&quot;│</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;├&quot;</span> <span class="o">+</span> <span class="s2">&quot;─&quot;</span> <span class="o">*</span> <span class="mi">30</span> <span class="o">+</span> <span class="s2">&quot;┼&quot;</span> <span class="o">+</span> <span class="s2">&quot;─&quot;</span> <span class="o">*</span> <span class="mi">15</span> <span class="o">+</span> <span class="s2">&quot;┼&quot;</span> <span class="o">+</span> <span class="s2">&quot;─&quot;</span> <span class="o">*</span> <span class="mi">15</span> <span class="o">+</span> <span class="s2">&quot;┤</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    
                    <span class="c1"># Valores de cada repositorio</span>
                    <span class="n">empresa_data</span> <span class="o">=</span> <span class="n">metricas</span><span class="p">[</span><span class="s1">&#39;repos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;empresa&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">categoria</span><span class="p">,</span> <span class="p">{})</span>
                    <span class="n">candidato_data</span> <span class="o">=</span> <span class="n">metricas</span><span class="p">[</span><span class="s1">&#39;repos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;candidato&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">categoria</span><span class="p">,</span> <span class="p">{})</span>
                    
                    <span class="c1"># Obtener todas las métricas únicas de ambos repos</span>
                    <span class="n">all_metrics</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">empresa_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">candidato_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                    
                    <span class="k">for</span> <span class="n">metrica</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">all_metrics</span><span class="p">):</span>
                        <span class="n">empresa_val</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">empresa_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">metrica</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span>
                        <span class="n">candidato_val</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">candidato_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">metrica</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span>
                        <span class="n">metrica_name</span> <span class="o">=</span> <span class="n">metrica</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>
                        
                        <span class="c1"># Alinear valores</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;│ </span><span class="si">{</span><span class="n">metrica_name</span><span class="si">:</span><span class="s2">&lt;30</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;│ </span><span class="si">{</span><span class="n">empresa_val</span><span class="si">:</span><span class="s2">&gt;15</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;│ </span><span class="si">{</span><span class="n">candidato_val</span><span class="si">:</span><span class="s2">&gt;15</span><span class="si">}</span><span class="s2">│</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;└&quot;</span> <span class="o">+</span> <span class="s2">&quot;─&quot;</span> <span class="o">*</span> <span class="mi">30</span> <span class="o">+</span> <span class="s2">&quot;┴&quot;</span> <span class="o">+</span> <span class="s2">&quot;─&quot;</span> <span class="o">*</span> <span class="mi">15</span> <span class="o">+</span> <span class="s2">&quot;┴&quot;</span> <span class="o">+</span> <span class="s2">&quot;─&quot;</span> <span class="o">*</span> <span class="mi">15</span> <span class="o">+</span> <span class="s2">&quot;┘</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    
                    <span class="c1"># Diferencias</span>
                    <span class="k">if</span> <span class="s1">&#39;diferencias&#39;</span> <span class="ow">in</span> <span class="n">metricas</span> <span class="ow">and</span> <span class="n">categoria</span> <span class="ow">in</span> <span class="n">metricas</span><span class="p">[</span><span class="s1">&#39;diferencias&#39;</span><span class="p">]:</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Diferencias:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">metrica</span><span class="p">,</span> <span class="n">diff</span> <span class="ow">in</span> <span class="n">metricas</span><span class="p">[</span><span class="s1">&#39;diferencias&#39;</span><span class="p">][</span><span class="n">categoria</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                            <span class="n">signo</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span> <span class="k">if</span> <span class="n">diff</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;• </span><span class="si">{</span><span class="n">metrica</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">signo</span><span class="si">}{</span><span class="n">diff</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="c1"># Nuevas métricas: Patrones, Rendimiento y Comentarios</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">80</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;ANÁLISIS AVANZADO</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">80</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
                
                <span class="c1"># Análisis de Patrones</span>
                <span class="k">if</span> <span class="s1">&#39;patrones&#39;</span> <span class="ow">in</span> <span class="n">metricas</span><span class="p">[</span><span class="s1">&#39;repos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;empresa&#39;</span><span class="p">,</span> <span class="p">{})</span> <span class="ow">or</span> <span class="s1">&#39;patrones&#39;</span> <span class="ow">in</span> <span class="n">metricas</span><span class="p">[</span><span class="s1">&#39;repos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;candidato&#39;</span><span class="p">,</span> <span class="p">{}):</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;PATRONES DE DISEÑO Y ANTI-PATRONES</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">35</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    
                    <span class="n">empresa_patterns</span> <span class="o">=</span> <span class="n">metricas</span><span class="p">[</span><span class="s1">&#39;repos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;empresa&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;patrones&#39;</span><span class="p">,</span> <span class="p">{})</span>
                    <span class="n">candidato_patterns</span> <span class="o">=</span> <span class="n">metricas</span><span class="p">[</span><span class="s1">&#39;repos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;candidato&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;patrones&#39;</span><span class="p">,</span> <span class="p">{})</span>
                    
                    <span class="c1"># Comparar patrones de diseño</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Patrones de Diseño Detectados:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">all_patterns</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">empresa_patterns</span><span class="p">:</span>
                        <span class="n">all_patterns</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">empresa_patterns</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;design_patterns&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                    <span class="k">if</span> <span class="n">candidato_patterns</span><span class="p">:</span>
                        <span class="n">all_patterns</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">candidato_patterns</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;design_patterns&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                    
                    <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">all_patterns</span><span class="p">):</span>
                        <span class="n">emp_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">empresa_patterns</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;design_patterns&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="p">[]))</span>
                        <span class="n">cand_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidato_patterns</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;design_patterns&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="p">[]))</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  • </span><span class="si">{</span><span class="n">pattern</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2">: Empresa: </span><span class="si">{</span><span class="n">emp_count</span><span class="si">}</span><span class="s2">, Candidato: </span><span class="si">{</span><span class="n">cand_count</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    
                    <span class="c1"># Anti-patrones</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Anti-patrones Detectados:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">all_antipatterns</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">empresa_patterns</span><span class="p">:</span>
                        <span class="n">all_antipatterns</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">empresa_patterns</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;anti_patterns&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                    <span class="k">if</span> <span class="n">candidato_patterns</span><span class="p">:</span>
                        <span class="n">all_antipatterns</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">candidato_patterns</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;anti_patterns&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                    
                    <span class="k">for</span> <span class="n">antipattern</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">all_antipatterns</span><span class="p">):</span>
                        <span class="n">emp_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">empresa_patterns</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;anti_patterns&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">antipattern</span><span class="p">,</span> <span class="p">[]))</span>
                        <span class="n">cand_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidato_patterns</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;anti_patterns&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">antipattern</span><span class="p">,</span> <span class="p">[]))</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  • </span><span class="si">{</span><span class="n">antipattern</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2">: Empresa: </span><span class="si">{</span><span class="n">emp_count</span><span class="si">}</span><span class="s2">, Candidato: </span><span class="si">{</span><span class="n">cand_count</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    
                    <span class="c1"># Scores</span>
                    <span class="n">emp_score</span> <span class="o">=</span> <span class="n">empresa_patterns</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pattern_score&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="n">empresa_patterns</span> <span class="k">else</span> <span class="mi">0</span>
                    <span class="n">cand_score</span> <span class="o">=</span> <span class="n">candidato_patterns</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pattern_score&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="n">candidato_patterns</span> <span class="k">else</span> <span class="mi">0</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Score de Patrones: Empresa: </span><span class="si">{</span><span class="n">emp_score</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">, Candidato: </span><span class="si">{</span><span class="n">cand_score</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
                
                <span class="c1"># Análisis de Rendimiento</span>
                <span class="k">if</span> <span class="s1">&#39;rendimiento&#39;</span> <span class="ow">in</span> <span class="n">metricas</span><span class="p">[</span><span class="s1">&#39;repos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;empresa&#39;</span><span class="p">,</span> <span class="p">{})</span> <span class="ow">or</span> <span class="s1">&#39;rendimiento&#39;</span> <span class="ow">in</span> <span class="n">metricas</span><span class="p">[</span><span class="s1">&#39;repos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;candidato&#39;</span><span class="p">,</span> <span class="p">{}):</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;ANÁLISIS DE RENDIMIENTO</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">22</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    
                    <span class="n">empresa_perf</span> <span class="o">=</span> <span class="n">metricas</span><span class="p">[</span><span class="s1">&#39;repos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;empresa&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rendimiento&#39;</span><span class="p">,</span> <span class="p">{})</span>
                    <span class="n">candidato_perf</span> <span class="o">=</span> <span class="n">metricas</span><span class="p">[</span><span class="s1">&#39;repos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;candidato&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rendimiento&#39;</span><span class="p">,</span> <span class="p">{})</span>
                    
                    <span class="c1"># Problemas de rendimiento</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Problemas de Rendimiento Detectados:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">all_issues</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">empresa_perf</span><span class="p">:</span>
                        <span class="n">all_issues</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">empresa_perf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;performance_issues&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                    <span class="k">if</span> <span class="n">candidato_perf</span><span class="p">:</span>
                        <span class="n">all_issues</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">candidato_perf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;performance_issues&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                    
                    <span class="k">for</span> <span class="n">issue</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">all_issues</span><span class="p">):</span>
                        <span class="n">emp_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">empresa_perf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;performance_issues&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">issue</span><span class="p">,</span> <span class="p">[]))</span>
                        <span class="n">cand_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidato_perf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;performance_issues&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">issue</span><span class="p">,</span> <span class="p">[]))</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  • </span><span class="si">{</span><span class="n">issue</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2">: Empresa: </span><span class="si">{</span><span class="n">emp_count</span><span class="si">}</span><span class="s2">, Candidato: </span><span class="si">{</span><span class="n">cand_count</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    
                    <span class="c1"># Scores</span>
                    <span class="n">emp_score</span> <span class="o">=</span> <span class="n">empresa_perf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;performance_score&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="n">empresa_perf</span> <span class="k">else</span> <span class="mi">0</span>
                    <span class="n">cand_score</span> <span class="o">=</span> <span class="n">candidato_perf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;performance_score&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="n">candidato_perf</span> <span class="k">else</span> <span class="mi">0</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Score de Rendimiento: Empresa: </span><span class="si">{</span><span class="n">emp_score</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">, Candidato: </span><span class="si">{</span><span class="n">cand_score</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
                
                <span class="c1"># Análisis de Comentarios</span>
                <span class="k">if</span> <span class="s1">&#39;comentarios&#39;</span> <span class="ow">in</span> <span class="n">metricas</span><span class="p">[</span><span class="s1">&#39;repos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;empresa&#39;</span><span class="p">,</span> <span class="p">{})</span> <span class="ow">or</span> <span class="s1">&#39;comentarios&#39;</span> <span class="ow">in</span> <span class="n">metricas</span><span class="p">[</span><span class="s1">&#39;repos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;candidato&#39;</span><span class="p">,</span> <span class="p">{}):</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;ANÁLISIS DE COMENTARIOS Y DOCUMENTACIÓN</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">38</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    
                    <span class="n">empresa_comments</span> <span class="o">=</span> <span class="n">metricas</span><span class="p">[</span><span class="s1">&#39;repos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;empresa&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;comentarios&#39;</span><span class="p">,</span> <span class="p">{})</span>
                    <span class="n">candidato_comments</span> <span class="o">=</span> <span class="n">metricas</span><span class="p">[</span><span class="s1">&#39;repos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;candidato&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;comentarios&#39;</span><span class="p">,</span> <span class="p">{})</span>
                    
                    <span class="c1"># Métricas de comentarios</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Métricas de Comentarios:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">emp_metrics</span> <span class="o">=</span> <span class="n">empresa_comments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;comment_metrics&#39;</span><span class="p">,</span> <span class="p">{})</span> <span class="k">if</span> <span class="n">empresa_comments</span> <span class="k">else</span> <span class="p">{}</span>
                    <span class="n">cand_metrics</span> <span class="o">=</span> <span class="n">candidato_comments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;comment_metrics&#39;</span><span class="p">,</span> <span class="p">{})</span> <span class="k">if</span> <span class="n">candidato_comments</span> <span class="k">else</span> <span class="p">{}</span>
                    
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  • Ratio de comentarios: Empresa: </span><span class="si">{</span><span class="n">emp_metrics</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;comment_ratio&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%, Candidato: </span><span class="si">{</span><span class="n">cand_metrics</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;comment_ratio&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  • Cobertura de documentación: Empresa: </span><span class="si">{</span><span class="n">emp_metrics</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;documentation_coverage&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%, Candidato: </span><span class="si">{</span><span class="n">cand_metrics</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;documentation_coverage&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    
                    <span class="c1"># Marcadores</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Marcadores Encontrados:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">all_markers</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">empresa_comments</span><span class="p">:</span>
                        <span class="n">all_markers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">empresa_comments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                    <span class="k">if</span> <span class="n">candidato_comments</span><span class="p">:</span>
                        <span class="n">all_markers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">candidato_comments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                    
                    <span class="k">for</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">all_markers</span><span class="p">):</span>
                        <span class="n">emp_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">empresa_comments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">marker</span><span class="p">,</span> <span class="p">[]))</span>
                        <span class="n">cand_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidato_comments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">marker</span><span class="p">,</span> <span class="p">[]))</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  • </span><span class="si">{</span><span class="n">marker</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">: Empresa: </span><span class="si">{</span><span class="n">emp_count</span><span class="si">}</span><span class="s2">, Candidato: </span><span class="si">{</span><span class="n">cand_count</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    
                    <span class="c1"># Scores</span>
                    <span class="n">emp_score</span> <span class="o">=</span> <span class="n">empresa_comments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;comment_score&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="n">empresa_comments</span> <span class="k">else</span> <span class="mi">0</span>
                    <span class="n">cand_score</span> <span class="o">=</span> <span class="n">candidato_comments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;comment_score&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="n">candidato_comments</span> <span class="k">else</span> <span class="mi">0</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Score de Comentarios: Empresa: </span><span class="si">{</span><span class="n">emp_score</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">, Candidato: </span><span class="si">{</span><span class="n">cand_score</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="c1"># Conclusión basada en análisis de empatía</span>
                <span class="k">if</span> <span class="s1">&#39;empathy_analysis&#39;</span> <span class="ow">in</span> <span class="n">metricas</span><span class="p">:</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">80</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;CONCLUSIÓN Y DECISIÓN DE CONTRATACIÓN</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">80</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    
                    <span class="n">analysis</span> <span class="o">=</span> <span class="n">metricas</span><span class="p">[</span><span class="s1">&#39;empathy_analysis&#39;</span><span class="p">]</span>
                    <span class="n">score</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;empathy_score&#39;</span><span class="p">]</span>
                    <span class="n">interpretation</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;interpretation&#39;</span><span class="p">]</span>

                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Puntuación Final de Empatía: </span><span class="si">{</span><span class="n">score</span><span class="si">}</span><span class="s2">%</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Nivel: </span><span class="si">{</span><span class="n">interpretation</span><span class="p">[</span><span class="s1">&#39;level&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Evaluación: </span><span class="si">{</span><span class="n">interpretation</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Decisión: </span><span class="si">{</span><span class="n">interpretation</span><span class="p">[</span><span class="s1">&#39;recommendation&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>

                    <span class="c1"># Fortalezas y debilidades</span>
                    <span class="k">if</span> <span class="s1">&#39;detailed_analysis&#39;</span> <span class="ow">in</span> <span class="n">analysis</span><span class="p">:</span>
                        <span class="n">detailed</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;detailed_analysis&#39;</span><span class="p">]</span>

                        <span class="k">if</span> <span class="n">detailed</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;strengths&#39;</span><span class="p">):</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;FORTALEZAS DEL CANDIDATO:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                            <span class="k">for</span> <span class="n">strength</span> <span class="ow">in</span> <span class="n">detailed</span><span class="p">[</span><span class="s1">&#39;strengths&#39;</span><span class="p">]:</span>
                                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  • </span><span class="si">{</span><span class="n">strength</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">strength</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                        <span class="k">if</span> <span class="n">detailed</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;weaknesses&#39;</span><span class="p">):</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;ÁREAS DE MEJORA:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                            <span class="k">for</span> <span class="n">weakness</span> <span class="ow">in</span> <span class="n">detailed</span><span class="p">[</span><span class="s1">&#39;weaknesses&#39;</span><span class="p">]:</span>
                                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  • </span><span class="si">{</span><span class="n">weakness</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">weakness</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error generando reporte TXT: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span></div>


<div class="viewcode-block" id="Exporter.exportar_json">
<a class="viewcode-back" href="../api/exporters.html#exporters.Exporter.exportar_json">[documentos]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">exportar_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metricas</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">timestamp</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exporta los resultados a formato JSON.</span>
<span class="sd">        </span>
<span class="sd">        Útil para procesamiento posterior o integración con otras</span>
<span class="sd">        herramientas.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            metricas: Diccionario con los resultados del análisis.</span>
<span class="sd">            timestamp: Marca de tiempo para el nombre del archivo.</span>
<span class="sd">        </span>
<span class="sd">        Raises:</span>
<span class="sd">            IOError: Si no se puede escribir el archivo.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s1">&#39;export&#39;</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">output_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;export/reporte_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s1">.json&#39;</span>
            
            <span class="c1"># Añadir timestamp al objeto de métricas</span>
            <span class="n">datos_export</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">timestamp</span><span class="p">,</span>
                <span class="s2">&quot;metricas&quot;</span><span class="p">:</span> <span class="n">metricas</span>
            <span class="p">}</span>
            
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">datos_export</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error generando reporte JSON: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span></div>


<div class="viewcode-block" id="Exporter.exportar_html">
<a class="viewcode-back" href="../api/exporters.html#exporters.Exporter.exportar_html">[documentos]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">exportar_html</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metricas</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">timestamp</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dashboard</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exporta los resultados a formato HTML.</span>
<span class="sd">        </span>
<span class="sd">        Puede generar un reporte estático o un dashboard interactivo</span>
<span class="sd">        con gráficos usando Chart.js.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            metricas: Diccionario con los resultados del análisis.</span>
<span class="sd">            timestamp: Marca de tiempo para el nombre del archivo.</span>
<span class="sd">            dashboard: Si True, genera dashboard interactivo.</span>
<span class="sd">        </span>
<span class="sd">        Raises:</span>
<span class="sd">            IOError: Si no se puede escribir el archivo.</span>
<span class="sd">            TemplateNotFound: Si no encuentra las plantillas HTML.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Para mantener compatibilidad, mapear empresa/candidato a A/B si es necesario</span>
            <span class="k">if</span> <span class="s1">&#39;empresa&#39;</span> <span class="ow">in</span> <span class="n">metricas</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;repos&#39;</span><span class="p">,</span> <span class="p">{}):</span>
                <span class="c1"># Nuevo formato empresa/candidato</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="s1">&#39;A&#39;</span> <span class="ow">in</span> <span class="n">metricas</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;repos&#39;</span><span class="p">,</span> <span class="p">{}):</span>
                <span class="c1"># Formato antiguo A/B - mantener compatibilidad</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Formato de métricas no reconocido&quot;</span><span class="p">)</span>

            <span class="c1"># Obtener la ruta del directorio de templates</span>
            <span class="n">root_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)))</span>
            <span class="n">template_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root_dir</span><span class="p">,</span> <span class="s2">&quot;templates&quot;</span><span class="p">)</span>
            
            <span class="n">env</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">(</span><span class="n">loader</span><span class="o">=</span><span class="n">FileSystemLoader</span><span class="p">(</span><span class="n">template_dir</span><span class="p">))</span>
            <span class="n">env</span><span class="o">.</span><span class="n">filters</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_date</span>
            <span class="n">env</span><span class="o">.</span><span class="n">filters</span><span class="p">[</span><span class="s1">&#39;format_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_date</span>

            <span class="c1"># Seleccionar plantilla según el tipo y formato de datos</span>
            <span class="k">if</span> <span class="n">dashboard</span><span class="p">:</span>
                <span class="c1"># Si tenemos análisis de empatía, usar el dashboard con Bootstrap</span>
                <span class="k">if</span> <span class="s1">&#39;empathy_analysis&#39;</span> <span class="ow">in</span> <span class="n">metricas</span><span class="p">:</span>
                    <span class="n">template</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_template</span><span class="p">(</span><span class="s1">&#39;dashboard_bootstrap.html&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Mantener compatibilidad con formato antiguo</span>
                    <span class="n">template</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_template</span><span class="p">(</span><span class="s1">&#39;dashboard.html&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Usar siempre el dashboard Bootstrap para HTML</span>
                <span class="k">if</span> <span class="s1">&#39;empathy_analysis&#39;</span> <span class="ow">in</span> <span class="n">metricas</span><span class="p">:</span>
                    <span class="n">template</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_template</span><span class="p">(</span><span class="s1">&#39;dashboard_bootstrap.html&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">template</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_template</span><span class="p">(</span><span class="s1">&#39;informe_template.html&#39;</span><span class="p">)</span>
            
            <span class="n">datos_template</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;titulo&quot;</span><span class="p">:</span> <span class="s2">&quot;Análisis de Empatía de Código&quot;</span><span class="p">,</span>
                <span class="s2">&quot;fecha_generacion&quot;</span><span class="p">:</span> <span class="n">timestamp</span><span class="p">,</span>
                <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">timestamp</span><span class="p">,</span>  <span class="c1"># Añadido para compatibilidad con las plantillas</span>
                <span class="s2">&quot;metricas&quot;</span><span class="p">:</span> <span class="n">metricas</span><span class="p">,</span>
                <span class="s2">&quot;categorias&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;nombres&quot;</span><span class="p">,</span> <span class="s2">&quot;complejidad&quot;</span><span class="p">,</span> <span class="s2">&quot;modularidad&quot;</span><span class="p">,</span> <span class="s2">&quot;documentacion&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;manejo_errores&quot;</span><span class="p">,</span> <span class="s2">&quot;pruebas&quot;</span><span class="p">,</span> <span class="s2">&quot;consistencia_estilo&quot;</span><span class="p">,</span> <span class="s2">&quot;seguridad&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
            
            <span class="n">html_content</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="o">**</span><span class="n">datos_template</span><span class="p">)</span>
            
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s1">&#39;export&#39;</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">output_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;export/reporte_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s1">.html&#39;</span>
            
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">html_content</span><span class="p">)</span>
                
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error generando reporte HTML: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span></div>


<div class="viewcode-block" id="Exporter.exportar_equipo">
<a class="viewcode-back" href="../api/exporters.html#exporters.Exporter.exportar_equipo">[documentos]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">exportar_equipo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resultados_equipo</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">timestamp</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Genera un reporte especial para análisis de equipo.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">archivo_salida</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;export&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;equipo_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">.html&quot;</span><span class="p">)</span>
            
            <span class="c1"># Preparar datos para el template</span>
            <span class="n">candidatos_ordenados</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
                <span class="n">resultados_equipo</span><span class="p">[</span><span class="s1">&#39;candidatos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span>
                <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;empathy_score&#39;</span><span class="p">],</span>
                <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
            
            <span class="c1"># Crear resumen comparativo</span>
            <span class="n">comparacion</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">nombre</span><span class="p">,</span> <span class="n">datos</span> <span class="ow">in</span> <span class="n">candidatos_ordenados</span><span class="p">:</span>
                <span class="n">comparacion</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s1">&#39;nombre&#39;</span><span class="p">:</span> <span class="n">nombre</span><span class="p">,</span>
                    <span class="s1">&#39;score&#39;</span><span class="p">:</span> <span class="n">datos</span><span class="p">[</span><span class="s1">&#39;empathy_score&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;nivel&#39;</span><span class="p">:</span> <span class="n">datos</span><span class="p">[</span><span class="s1">&#39;empathy_analysis&#39;</span><span class="p">][</span><span class="s1">&#39;interpretation&#39;</span><span class="p">][</span><span class="s1">&#39;level&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">datos</span><span class="p">[</span><span class="s1">&#39;empathy_analysis&#39;</span><span class="p">][</span><span class="s1">&#39;interpretation&#39;</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;recomendacion&#39;</span><span class="p">:</span> <span class="n">datos</span><span class="p">[</span><span class="s1">&#39;empathy_analysis&#39;</span><span class="p">][</span><span class="s1">&#39;interpretation&#39;</span><span class="p">][</span><span class="s1">&#39;recommendation&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;fortalezas&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">datos</span><span class="p">[</span><span class="s1">&#39;empathy_analysis&#39;</span><span class="p">][</span><span class="s1">&#39;detailed_analysis&#39;</span><span class="p">][</span><span class="s1">&#39;strengths&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">80</span><span class="p">],</span>
                    <span class="s1">&#39;debilidades&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">datos</span><span class="p">[</span><span class="s1">&#39;empathy_analysis&#39;</span><span class="p">][</span><span class="s1">&#39;detailed_analysis&#39;</span><span class="p">][</span><span class="s1">&#39;weaknesses&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">60</span><span class="p">],</span>
                    <span class="s1">&#39;lenguajes&#39;</span><span class="p">:</span> <span class="n">datos</span><span class="p">[</span><span class="s1">&#39;analisis&#39;</span><span class="p">][</span><span class="s1">&#39;metadata&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;lenguajes_analizados&#39;</span><span class="p">,</span> <span class="p">[]),</span>
                    <span class="s1">&#39;category_scores&#39;</span><span class="p">:</span> <span class="n">datos</span><span class="p">[</span><span class="s1">&#39;empathy_analysis&#39;</span><span class="p">][</span><span class="s1">&#39;category_scores&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;duplicacion&#39;</span><span class="p">:</span> <span class="n">datos</span><span class="p">[</span><span class="s1">&#39;analisis&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;duplicacion&#39;</span><span class="p">,</span> <span class="p">{}),</span>
                    <span class="s1">&#39;dependencias&#39;</span><span class="p">:</span> <span class="n">datos</span><span class="p">[</span><span class="s1">&#39;analisis&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dependencias&#39;</span><span class="p">,</span> <span class="p">{}),</span>
                    <span class="s1">&#39;patrones&#39;</span><span class="p">:</span> <span class="n">datos</span><span class="p">[</span><span class="s1">&#39;analisis&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;patrones&#39;</span><span class="p">,</span> <span class="p">{}),</span>
                    <span class="s1">&#39;rendimiento&#39;</span><span class="p">:</span> <span class="n">datos</span><span class="p">[</span><span class="s1">&#39;analisis&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rendimiento&#39;</span><span class="p">,</span> <span class="p">{}),</span>
                    <span class="s1">&#39;comentarios&#39;</span><span class="p">:</span> <span class="n">datos</span><span class="p">[</span><span class="s1">&#39;analisis&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;comentarios&#39;</span><span class="p">,</span> <span class="p">{}),</span>
                    <span class="s1">&#39;metadata&#39;</span><span class="p">:</span> <span class="n">datos</span><span class="p">[</span><span class="s1">&#39;analisis&#39;</span><span class="p">][</span><span class="s1">&#39;metadata&#39;</span><span class="p">]</span>
                <span class="p">})</span>
            
            <span class="c1"># Generar HTML personalizado para equipo</span>
            <span class="n">html_content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generar_html_equipo</span><span class="p">(</span>
                <span class="n">resultados_equipo</span><span class="p">[</span><span class="s1">&#39;empresa&#39;</span><span class="p">],</span>
                <span class="n">comparacion</span><span class="p">,</span>
                <span class="n">timestamp</span>
            <span class="p">)</span>
            
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">archivo_salida</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">html_content</span><span class="p">)</span>
            
            <span class="c1"># También generar JSON para análisis posterior</span>
            <span class="n">json_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;export&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;equipo_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">.json&quot;</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">json_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">resultados_equipo</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reporte de equipo generado: </span><span class="si">{</span><span class="n">archivo_salida</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error generando reporte de equipo: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span></div>

    
    <span class="k">def</span><span class="w"> </span><span class="nf">_generar_html_equipo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">empresa_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">candidatos</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">],</span> <span class="n">timestamp</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Genera HTML personalizado para reporte de equipo con información detallada.&quot;&quot;&quot;</span>
        
        <span class="c1"># Preparar datos para gráficos</span>
        <span class="n">categorias</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;nombres&#39;</span><span class="p">,</span> <span class="s1">&#39;documentacion&#39;</span><span class="p">,</span> <span class="s1">&#39;modularidad&#39;</span><span class="p">,</span> <span class="s1">&#39;complejidad&#39;</span><span class="p">,</span> <span class="s1">&#39;manejo_errores&#39;</span><span class="p">,</span> <span class="s1">&#39;pruebas&#39;</span><span class="p">,</span> <span class="s1">&#39;seguridad&#39;</span><span class="p">,</span> <span class="s1">&#39;consistencia_estilo&#39;</span><span class="p">]</span>
        <span class="n">categorias_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">cat</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span> <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">categorias</span><span class="p">]</span>
        
        <span class="n">html</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;&lt;!DOCTYPE html&gt;</span>
<span class="s2">&lt;html lang=&quot;es&quot;&gt;</span>
<span class="s2">&lt;head&gt;</span>
<span class="s2">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span>
<span class="s2">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span>
<span class="s2">    &lt;title&gt;ANÁLISIS DE EQUIPO - CODE EMPATHIZER&lt;/title&gt;</span>
<span class="s2">    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/chart.js&quot;&gt;&lt;/script&gt;</span>
<span class="s2">    &lt;style&gt;</span>
<span class="s2">        * </span><span class="se">{{</span>
<span class="s2">            margin: 0;</span>
<span class="s2">            padding: 0;</span>
<span class="s2">            box-sizing: border-box;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        body </span><span class="se">{{</span>
<span class="s2">            font-family: -apple-system, BlinkMacSystemFont, &#39;Segoe UI&#39;, Roboto, sans-serif;</span>
<span class="s2">            background: #f5f7fa;</span>
<span class="s2">            color: #333;</span>
<span class="s2">            line-height: 1.6;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .container </span><span class="se">{{</span>
<span class="s2">            max-width: 1600px;</span>
<span class="s2">            margin: 0 auto;</span>
<span class="s2">            padding: 20px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .header </span><span class="se">{{</span>
<span class="s2">            background: #000000;</span>
<span class="s2">            color: white;</span>
<span class="s2">            padding: 40px;</span>
<span class="s2">            text-align: center;</span>
<span class="s2">            border-radius: 10px;</span>
<span class="s2">            margin-bottom: 30px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .header h1 </span><span class="se">{{</span>
<span class="s2">            font-size: 2.5em;</span>
<span class="s2">            margin-bottom: 10px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .empresa-info </span><span class="se">{{</span>
<span class="s2">            background: white;</span>
<span class="s2">            padding: 30px;</span>
<span class="s2">            border-radius: 10px;</span>
<span class="s2">            margin-bottom: 30px;</span>
<span class="s2">            box-shadow: 0 5px 20px rgba(0,0,0,0.08);</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .empresa-info h2 </span><span class="se">{{</span>
<span class="s2">            color: #333;</span>
<span class="s2">            margin-bottom: 20px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .chart-section </span><span class="se">{{</span>
<span class="s2">            background: white;</span>
<span class="s2">            padding: 30px;</span>
<span class="s2">            border-radius: 10px;</span>
<span class="s2">            margin-bottom: 30px;</span>
<span class="s2">            box-shadow: 0 5px 20px rgba(0,0,0,0.08);</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .chart-container </span><span class="se">{{</span>
<span class="s2">            position: relative;</span>
<span class="s2">            height: 400px;</span>
<span class="s2">            margin: 20px 0;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .candidato-card </span><span class="se">{{</span>
<span class="s2">            background: #f8f9fa;</span>
<span class="s2">            padding: 30px;</span>
<span class="s2">            margin: 20px 0;</span>
<span class="s2">            border-radius: 10px;</span>
<span class="s2">            border-left: 5px solid #333;</span>
<span class="s2">            box-shadow: 0 5px 20px rgba(0,0,0,0.08);</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .candidato-card.top </span><span class="se">{{</span>
<span class="s2">            border-left-color: #000;</span>
<span class="s2">            background: #f0f0f0;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .candidato-header </span><span class="se">{{</span>
<span class="s2">            display: flex;</span>
<span class="s2">            justify-content: space-between;</span>
<span class="s2">            align-items: center;</span>
<span class="s2">            margin-bottom: 20px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .candidato-nombre </span><span class="se">{{</span>
<span class="s2">            font-size: 1.5em;</span>
<span class="s2">            font-weight: bold;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .candidato-score </span><span class="se">{{</span>
<span class="s2">            font-size: 2.5em;</span>
<span class="s2">            font-weight: bold;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .metricas-grid </span><span class="se">{{</span>
<span class="s2">            display: grid;</span>
<span class="s2">            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));</span>
<span class="s2">            gap: 20px;</span>
<span class="s2">            margin: 20px 0;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .metrica-item </span><span class="se">{{</span>
<span class="s2">            background: white;</span>
<span class="s2">            padding: 20px;</span>
<span class="s2">            border-radius: 8px;</span>
<span class="s2">            text-align: center;</span>
<span class="s2">            border: 1px solid #e0e0e0;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .metrica-label </span><span class="se">{{</span>
<span class="s2">            font-size: 0.9em;</span>
<span class="s2">            color: #666;</span>
<span class="s2">            margin-bottom: 5px;</span>
<span class="s2">            text-transform: uppercase;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .metrica-value </span><span class="se">{{</span>
<span class="s2">            font-size: 1.8em;</span>
<span class="s2">            font-weight: bold;</span>
<span class="s2">            color: #333;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .fortalezas-debilidades </span><span class="se">{{</span>
<span class="s2">            display: grid;</span>
<span class="s2">            grid-template-columns: 1fr 1fr;</span>
<span class="s2">            gap: 20px;</span>
<span class="s2">            margin: 20px 0;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .lista-items </span><span class="se">{{</span>
<span class="s2">            background: white;</span>
<span class="s2">            padding: 20px;</span>
<span class="s2">            border-radius: 8px;</span>
<span class="s2">            border: 1px solid #e0e0e0;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .lista-items h4 </span><span class="se">{{</span>
<span class="s2">            color: #333;</span>
<span class="s2">            margin-bottom: 15px;</span>
<span class="s2">            font-size: 1.1em;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .lista-items ul </span><span class="se">{{</span>
<span class="s2">            list-style: none;</span>
<span class="s2">            padding: 0;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .lista-items li </span><span class="se">{{</span>
<span class="s2">            padding: 8px 0;</span>
<span class="s2">            border-bottom: 1px solid #f0f0f0;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .lista-items li:last-child </span><span class="se">{{</span>
<span class="s2">            border-bottom: none;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .score-badge </span><span class="se">{{</span>
<span class="s2">            display: inline-block;</span>
<span class="s2">            padding: 2px 8px;</span>
<span class="s2">            border-radius: 12px;</span>
<span class="s2">            font-size: 0.8em;</span>
<span class="s2">            margin-left: 10px;</span>
<span class="s2">            background: #e0e0e0;</span>
<span class="s2">            color: #333;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .lenguajes </span><span class="se">{{</span>
<span class="s2">            display: flex;</span>
<span class="s2">            flex-wrap: wrap;</span>
<span class="s2">            gap: 8px;</span>
<span class="s2">            margin-top: 10px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .lenguaje-tag </span><span class="se">{{</span>
<span class="s2">            background: #e0e0e0;</span>
<span class="s2">            padding: 6px 15px;</span>
<span class="s2">            border-radius: 20px;</span>
<span class="s2">            font-size: 0.9em;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .posicion </span><span class="se">{{</span>
<span class="s2">            display: inline-block;</span>
<span class="s2">            width: 50px;</span>
<span class="s2">            height: 50px;</span>
<span class="s2">            background: #333;</span>
<span class="s2">            color: white;</span>
<span class="s2">            border-radius: 50%;</span>
<span class="s2">            text-align: center;</span>
<span class="s2">            line-height: 50px;</span>
<span class="s2">            font-weight: bold;</span>
<span class="s2">            font-size: 1.2em;</span>
<span class="s2">            margin-right: 15px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .posicion.gold </span><span class="se">{{</span><span class="s2"> background: #FFD700; color: #333; </span><span class="se">}}</span>
<span class="s2">        .posicion.silver </span><span class="se">{{</span><span class="s2"> background: #C0C0C0; color: #333; </span><span class="se">}}</span>
<span class="s2">        .posicion.bronze </span><span class="se">{{</span><span class="s2"> background: #CD7F32; color: white; </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .info-adicional </span><span class="se">{{</span>
<span class="s2">            display: grid;</span>
<span class="s2">            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));</span>
<span class="s2">            gap: 20px;</span>
<span class="s2">            margin-top: 20px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .info-card </span><span class="se">{{</span>
<span class="s2">            background: white;</span>
<span class="s2">            padding: 20px;</span>
<span class="s2">            border-radius: 8px;</span>
<span class="s2">            border: 1px solid #e0e0e0;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .info-card h5 </span><span class="se">{{</span>
<span class="s2">            color: #666;</span>
<span class="s2">            margin-bottom: 10px;</span>
<span class="s2">            font-size: 1em;</span>
<span class="s2">            text-transform: uppercase;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .info-card p </span><span class="se">{{</span>
<span class="s2">            font-size: 1.5em;</span>
<span class="s2">            font-weight: bold;</span>
<span class="s2">            color: #333;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .comparacion-tabla </span><span class="se">{{</span>
<span class="s2">            background: white;</span>
<span class="s2">            padding: 30px;</span>
<span class="s2">            border-radius: 10px;</span>
<span class="s2">            margin-bottom: 30px;</span>
<span class="s2">            box-shadow: 0 5px 20px rgba(0,0,0,0.08);</span>
<span class="s2">            overflow-x: auto;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        table </span><span class="se">{{</span>
<span class="s2">            width: 100%;</span>
<span class="s2">            border-collapse: collapse;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        th, td </span><span class="se">{{</span>
<span class="s2">            padding: 12px;</span>
<span class="s2">            text-align: left;</span>
<span class="s2">            border-bottom: 1px solid #e0e0e0;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        th </span><span class="se">{{</span>
<span class="s2">            background: #f8f9fa;</span>
<span class="s2">            font-weight: 600;</span>
<span class="s2">            color: #333;</span>
<span class="s2">            position: sticky;</span>
<span class="s2">            top: 0;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        tr:hover </span><span class="se">{{</span>
<span class="s2">            background: #f8f9fa;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        </span>
<span class="s2">        .footer </span><span class="se">{{</span>
<span class="s2">            text-align: center;</span>
<span class="s2">            padding: 30px 0;</span>
<span class="s2">            color: #666;</span>
<span class="s2">            font-size: 0.9em;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">    &lt;/style&gt;</span>
<span class="s2">&lt;/head&gt;</span>
<span class="s2">&lt;body&gt;</span>
<span class="s2">    &lt;div class=&quot;container&quot;&gt;</span>
<span class="s2">        &lt;div class=&quot;header&quot;&gt;</span>
<span class="s2">            &lt;h1&gt;ANÁLISIS DE EQUIPO&lt;/h1&gt;</span>
<span class="s2">            &lt;p&gt;EVALUACIÓN COMPARATIVA DE CANDIDATOS&lt;/p&gt;</span>
<span class="s2">            &lt;p style=&quot;margin-top: 10px; opacity: 0.8;&quot;&gt;Generado el </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">format_date</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span><span class="si">}</span><span class="s2">&lt;/p&gt;</span>
<span class="s2">        &lt;/div&gt;</span>
<span class="s2">        </span>
<span class="s2">        &lt;div class=&quot;empresa-info&quot;&gt;</span>
<span class="s2">            &lt;h2&gt;Empresa de Referencia&lt;/h2&gt;</span>
<span class="s2">            &lt;p&gt;&lt;strong&gt;Repositorio:&lt;/strong&gt; </span><span class="si">{</span><span class="n">empresa_data</span><span class="p">[</span><span class="s1">&#39;metadata&#39;</span><span class="p">][</span><span class="s1">&#39;nombre&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&lt;/p&gt;</span>
<span class="s2">            &lt;p&gt;&lt;strong&gt;URL:&lt;/strong&gt; &lt;a href=&quot;</span><span class="si">{</span><span class="n">empresa_data</span><span class="p">[</span><span class="s1">&#39;metadata&#39;</span><span class="p">][</span><span class="s1">&#39;url&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot; target=&quot;_blank&quot;&gt;</span><span class="si">{</span><span class="n">empresa_data</span><span class="p">[</span><span class="s1">&#39;metadata&#39;</span><span class="p">][</span><span class="s1">&#39;url&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&lt;/a&gt;&lt;/p&gt;</span>
<span class="s2">            &lt;p&gt;&lt;strong&gt;Lenguaje Principal:&lt;/strong&gt; </span><span class="si">{</span><span class="n">empresa_data</span><span class="p">[</span><span class="s1">&#39;metadata&#39;</span><span class="p">][</span><span class="s1">&#39;lenguaje_principal&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&lt;/p&gt;</span>
<span class="s2">            &lt;p&gt;&lt;strong&gt;Archivos Analizados:&lt;/strong&gt; </span><span class="si">{</span><span class="n">empresa_data</span><span class="p">[</span><span class="s1">&#39;metadata&#39;</span><span class="p">][</span><span class="s1">&#39;archivos_analizados&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&lt;/p&gt;</span>
<span class="s2">            &lt;p&gt;&lt;strong&gt;Tamaño:&lt;/strong&gt; </span><span class="si">{</span><span class="n">empresa_data</span><span class="p">[</span><span class="s1">&#39;metadata&#39;</span><span class="p">][</span><span class="s1">&#39;tamano_kb&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> KB&lt;/p&gt;</span>
<span class="s2">        &lt;/div&gt;</span>
<span class="s2">        </span>
<span class="s2">        &lt;!-- Gráfico Comparativo --&gt;</span>
<span class="s2">        &lt;div class=&quot;chart-section&quot;&gt;</span>
<span class="s2">            &lt;h2&gt;Comparación Visual de Candidatos&lt;/h2&gt;</span>
<span class="s2">            &lt;div class=&quot;chart-container&quot;&gt;</span>
<span class="s2">                &lt;canvas id=&quot;comparisonChart&quot;&gt;&lt;/canvas&gt;</span>
<span class="s2">            &lt;/div&gt;</span>
<span class="s2">        &lt;/div&gt;</span>
<span class="s2">        </span>
<span class="s2">        &lt;!-- Tabla Comparativa --&gt;</span>
<span class="s2">        &lt;div class=&quot;comparacion-tabla&quot;&gt;</span>
<span class="s2">            &lt;h2&gt;Tabla Comparativa Detallada&lt;/h2&gt;</span>
<span class="s2">            &lt;table&gt;</span>
<span class="s2">                &lt;thead&gt;</span>
<span class="s2">                    &lt;tr&gt;</span>
<span class="s2">                        &lt;th&gt;Métrica&lt;/th&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>
        
        <span class="c1"># Headers de candidatos</span>
        <span class="k">for</span> <span class="n">candidato</span> <span class="ow">in</span> <span class="n">candidatos</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;th&gt;</span><span class="si">{</span><span class="n">candidato</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&lt;/th&gt;&quot;</span>
        
        <span class="n">html</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                &lt;/thead&gt;</span>
<span class="s2">                &lt;tbody&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>
        
        <span class="c1"># Filas de métricas</span>
        <span class="k">for</span> <span class="n">categoria</span> <span class="ow">in</span> <span class="n">categorias</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;</span><span class="si">{</span><span class="n">categoria</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2">&lt;/strong&gt;&lt;/td&gt;&quot;</span>
            <span class="k">for</span> <span class="n">candidato</span> <span class="ow">in</span> <span class="n">candidatos</span><span class="p">:</span>
                <span class="n">score</span> <span class="o">=</span> <span class="n">candidato</span><span class="p">[</span><span class="s1">&#39;category_scores&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">categoria</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;td&gt;</span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&lt;/td&gt;&quot;</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/tr&gt;&quot;</span>
        
        <span class="c1"># Agregar métricas adicionales</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    &lt;tr&gt;&lt;td&gt;&lt;strong&gt;Duplicación de Código&lt;/strong&gt;&lt;/td&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">candidato</span> <span class="ow">in</span> <span class="n">candidatos</span><span class="p">:</span>
            <span class="n">dup</span> <span class="o">=</span> <span class="n">candidato</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;duplicacion&#39;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="n">porcentaje</span> <span class="o">=</span> <span class="n">dup</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;porcentaje_global&#39;</span><span class="p">,</span> <span class="s1">&#39;N/A&#39;</span><span class="p">)</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;td&gt;</span><span class="si">{</span><span class="n">porcentaje</span><span class="si">}</span><span class="s2">%&lt;/td&gt;&quot;</span> <span class="k">if</span> <span class="n">porcentaje</span> <span class="o">!=</span> <span class="s1">&#39;N/A&#39;</span> <span class="k">else</span> <span class="s2">&quot;&lt;td&gt;N/A&lt;/td&gt;&quot;</span>
        
        <span class="n">html</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                    &lt;tr&gt;&lt;td&gt;&lt;strong&gt;Dependencias Totales&lt;/strong&gt;&lt;/td&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">candidato</span> <span class="ow">in</span> <span class="n">candidatos</span><span class="p">:</span>
            <span class="n">deps</span> <span class="o">=</span> <span class="n">candidato</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dependencias&#39;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="n">total</span> <span class="o">=</span> <span class="n">deps</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;total_dependencies&#39;</span><span class="p">,</span> <span class="s1">&#39;N/A&#39;</span><span class="p">)</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;td&gt;</span><span class="si">{</span><span class="n">total</span><span class="si">}</span><span class="s2">&lt;/td&gt;&quot;</span>
        
        <span class="n">html</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                    &lt;tr&gt;&lt;td&gt;&lt;strong&gt;Score de Patrones&lt;/strong&gt;&lt;/td&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">candidato</span> <span class="ow">in</span> <span class="n">candidatos</span><span class="p">:</span>
            <span class="n">patrones</span> <span class="o">=</span> <span class="n">candidato</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;patrones&#39;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="n">score</span> <span class="o">=</span> <span class="n">patrones</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pattern_score&#39;</span><span class="p">,</span> <span class="s1">&#39;N/A&#39;</span><span class="p">)</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;td&gt;</span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&lt;/td&gt;&quot;</span> <span class="k">if</span> <span class="n">score</span> <span class="o">!=</span> <span class="s1">&#39;N/A&#39;</span> <span class="k">else</span> <span class="s2">&quot;&lt;td&gt;N/A&lt;/td&gt;&quot;</span>
        
        <span class="n">html</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                    &lt;tr&gt;&lt;td&gt;&lt;strong&gt;Score de Rendimiento&lt;/strong&gt;&lt;/td&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">candidato</span> <span class="ow">in</span> <span class="n">candidatos</span><span class="p">:</span>
            <span class="n">perf</span> <span class="o">=</span> <span class="n">candidato</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rendimiento&#39;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="n">score</span> <span class="o">=</span> <span class="n">perf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;performance_score&#39;</span><span class="p">,</span> <span class="s1">&#39;N/A&#39;</span><span class="p">)</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;td&gt;</span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&lt;/td&gt;&quot;</span> <span class="k">if</span> <span class="n">score</span> <span class="o">!=</span> <span class="s1">&#39;N/A&#39;</span> <span class="k">else</span> <span class="s2">&quot;&lt;td&gt;N/A&lt;/td&gt;&quot;</span>
        
        <span class="n">html</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                    &lt;tr&gt;&lt;td&gt;&lt;strong&gt;Score de Comentarios&lt;/strong&gt;&lt;/td&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">candidato</span> <span class="ow">in</span> <span class="n">candidatos</span><span class="p">:</span>
            <span class="n">comments</span> <span class="o">=</span> <span class="n">candidato</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;comentarios&#39;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="n">score</span> <span class="o">=</span> <span class="n">comments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;comment_score&#39;</span><span class="p">,</span> <span class="s1">&#39;N/A&#39;</span><span class="p">)</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;td&gt;</span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&lt;/td&gt;&quot;</span> <span class="k">if</span> <span class="n">score</span> <span class="o">!=</span> <span class="s1">&#39;N/A&#39;</span> <span class="k">else</span> <span class="s2">&quot;&lt;td&gt;N/A&lt;/td&gt;&quot;</span>
        
        <span class="n">html</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                    &lt;tr&gt;&lt;td&gt;&lt;strong&gt;Archivos Analizados&lt;/strong&gt;&lt;/td&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">candidato</span> <span class="ow">in</span> <span class="n">candidatos</span><span class="p">:</span>
            <span class="n">archivos</span> <span class="o">=</span> <span class="n">candidato</span><span class="p">[</span><span class="s1">&#39;metadata&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;archivos_analizados&#39;</span><span class="p">,</span> <span class="s1">&#39;N/A&#39;</span><span class="p">)</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;td&gt;</span><span class="si">{</span><span class="n">archivos</span><span class="si">}</span><span class="s2">&lt;/td&gt;&quot;</span>
        
        <span class="n">html</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                &lt;/tbody&gt;</span>
<span class="s2">            &lt;/table&gt;</span>
<span class="s2">        &lt;/div&gt;</span>
<span class="s2">        </span>
<span class="s2">        &lt;!-- Detalles de cada candidato --&gt;</span>
<span class="s2">        &lt;h2 style=&quot;text-align: center; margin: 30px 0;&quot;&gt;Análisis Detallado por Candidato&lt;/h2&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>
        
        <span class="c1"># Agregar cada candidato con información detallada</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">candidato</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">candidatos</span><span class="p">):</span>
            <span class="n">posicion_class</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">posicion_class</span> <span class="o">=</span> <span class="s1">&#39;gold&#39;</span>
            <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">posicion_class</span> <span class="o">=</span> <span class="s1">&#39;silver&#39;</span>
            <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">posicion_class</span> <span class="o">=</span> <span class="s1">&#39;bronze&#39;</span>
            
            <span class="n">card_class</span> <span class="o">=</span> <span class="s1">&#39;candidato-card&#39;</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">card_class</span> <span class="o">+=</span> <span class="s1">&#39; top&#39;</span>
            
            <span class="n">html</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            &lt;div class=&quot;</span><span class="si">{</span><span class="n">card_class</span><span class="si">}</span><span class="s2">&quot;&gt;</span>
<span class="s2">                &lt;div class=&quot;candidato-header&quot;&gt;</span>
<span class="s2">                    &lt;div&gt;</span>
<span class="s2">                        &lt;span class=&quot;posicion </span><span class="si">{</span><span class="n">posicion_class</span><span class="si">}</span><span class="s2">&quot;&gt;</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&lt;/span&gt;</span>
<span class="s2">                        &lt;span class=&quot;candidato-nombre&quot;&gt;</span><span class="si">{</span><span class="n">candidato</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&lt;/span&gt;</span>
<span class="s2">                    &lt;/div&gt;</span>
<span class="s2">                    &lt;div class=&quot;candidato-score&quot; style=&quot;color: </span><span class="si">{</span><span class="n">candidato</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;&gt;</span>
<span class="s2">                        </span><span class="si">{</span><span class="n">candidato</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%</span>
<span class="s2">                    &lt;/div&gt;</span>
<span class="s2">                &lt;/div&gt;</span>
<span class="s2">                </span>
<span class="s2">                &lt;p&gt;&lt;strong&gt;Nivel:&lt;/strong&gt; </span><span class="si">{</span><span class="n">candidato</span><span class="p">[</span><span class="s1">&#39;nivel&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&lt;/p&gt;</span>
<span class="s2">                &lt;p&gt;&lt;strong&gt;Recomendación:&lt;/strong&gt; </span><span class="si">{</span><span class="n">candidato</span><span class="p">[</span><span class="s1">&#39;recomendacion&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&lt;/p&gt;</span>
<span class="s2">                &lt;p&gt;&lt;strong&gt;URL:&lt;/strong&gt; &lt;a href=&quot;</span><span class="si">{</span><span class="n">candidato</span><span class="p">[</span><span class="s1">&#39;metadata&#39;</span><span class="p">][</span><span class="s1">&#39;url&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot; target=&quot;_blank&quot;&gt;</span><span class="si">{</span><span class="n">candidato</span><span class="p">[</span><span class="s1">&#39;metadata&#39;</span><span class="p">][</span><span class="s1">&#39;url&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&lt;/a&gt;&lt;/p&gt;</span>
<span class="s2">                </span>
<span class="s2">                &lt;!-- Métricas principales --&gt;</span>
<span class="s2">                &lt;div class=&quot;metricas-grid&quot;&gt;</span>
<span class="s2">                    &lt;div class=&quot;metrica-item&quot;&gt;</span>
<span class="s2">                        &lt;div class=&quot;metrica-label&quot;&gt;Documentación&lt;/div&gt;</span>
<span class="s2">                        &lt;div class=&quot;metrica-value&quot;&gt;</span><span class="si">{</span><span class="n">candidato</span><span class="p">[</span><span class="s1">&#39;category_scores&#39;</span><span class="p">][</span><span class="s1">&#39;documentacion&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&lt;/div&gt;</span>
<span class="s2">                    &lt;/div&gt;</span>
<span class="s2">                    &lt;div class=&quot;metrica-item&quot;&gt;</span>
<span class="s2">                        &lt;div class=&quot;metrica-label&quot;&gt;Pruebas&lt;/div&gt;</span>
<span class="s2">                        &lt;div class=&quot;metrica-value&quot;&gt;</span><span class="si">{</span><span class="n">candidato</span><span class="p">[</span><span class="s1">&#39;category_scores&#39;</span><span class="p">][</span><span class="s1">&#39;pruebas&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&lt;/div&gt;</span>
<span class="s2">                    &lt;/div&gt;</span>
<span class="s2">                    &lt;div class=&quot;metrica-item&quot;&gt;</span>
<span class="s2">                        &lt;div class=&quot;metrica-label&quot;&gt;Complejidad&lt;/div&gt;</span>
<span class="s2">                        &lt;div class=&quot;metrica-value&quot;&gt;</span><span class="si">{</span><span class="n">candidato</span><span class="p">[</span><span class="s1">&#39;category_scores&#39;</span><span class="p">][</span><span class="s1">&#39;complejidad&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&lt;/div&gt;</span>
<span class="s2">                    &lt;/div&gt;</span>
<span class="s2">                    &lt;div class=&quot;metrica-item&quot;&gt;</span>
<span class="s2">                        &lt;div class=&quot;metrica-label&quot;&gt;Seguridad&lt;/div&gt;</span>
<span class="s2">                        &lt;div class=&quot;metrica-value&quot;&gt;</span><span class="si">{</span><span class="n">candidato</span><span class="p">[</span><span class="s1">&#39;category_scores&#39;</span><span class="p">][</span><span class="s1">&#39;seguridad&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&lt;/div&gt;</span>
<span class="s2">                    &lt;/div&gt;</span>
<span class="s2">                &lt;/div&gt;</span>
<span class="s2">                </span>
<span class="s2">                &lt;!-- Fortalezas y Debilidades --&gt;</span>
<span class="s2">                &lt;div class=&quot;fortalezas-debilidades&quot;&gt;</span>
<span class="s2">                    &lt;div class=&quot;lista-items&quot;&gt;</span>
<span class="s2">                        &lt;h4&gt;Fortalezas (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">candidato</span><span class="p">[</span><span class="s2">&quot;fortalezas&quot;</span><span class="p">])</span><span class="si">}</span><span class="s2">)&lt;/h4&gt;</span>
<span class="s2">                        &lt;ul&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>
            
            <span class="c1"># Listar fortalezas</span>
            <span class="k">for</span> <span class="n">fortaleza</span> <span class="ow">in</span> <span class="n">candidato</span><span class="p">[</span><span class="s1">&#39;fortalezas&#39;</span><span class="p">][:</span><span class="mi">5</span><span class="p">]:</span>  <span class="c1"># Mostrar máximo 5</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                            &lt;li&gt;</span>
<span class="s2">                                </span><span class="si">{</span><span class="n">fortaleza</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span>
<span class="s2">                                &lt;span class=&quot;score-badge&quot;&gt;</span><span class="si">{</span><span class="n">fortaleza</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&lt;/span&gt;</span>
<span class="s2">                            &lt;/li&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>
            
            <span class="n">html</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                        &lt;/ul&gt;</span>
<span class="s2">                    &lt;/div&gt;</span>
<span class="s2">                    &lt;div class=&quot;lista-items&quot;&gt;</span>
<span class="s2">                        &lt;h4&gt;Áreas de Mejora ({len(candidato[&quot;debilidades&quot;])})&lt;/h4&gt;</span>
<span class="s2">                        &lt;ul&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>
            
            <span class="c1"># Listar debilidades</span>
            <span class="k">for</span> <span class="n">debilidad</span> <span class="ow">in</span> <span class="n">candidato</span><span class="p">[</span><span class="s1">&#39;debilidades&#39;</span><span class="p">][:</span><span class="mi">5</span><span class="p">]:</span>  <span class="c1"># Mostrar máximo 5</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                            &lt;li&gt;</span>
<span class="s2">                                </span><span class="si">{</span><span class="n">debilidad</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span>
<span class="s2">                                &lt;span class=&quot;score-badge&quot;&gt;</span><span class="si">{</span><span class="n">debilidad</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&lt;/span&gt;</span>
<span class="s2">                            &lt;/li&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>
            
            <span class="n">html</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                        &lt;/ul&gt;</span>
<span class="s2">                    &lt;/div&gt;</span>
<span class="s2">                &lt;/div&gt;</span>
<span class="s2">                </span>
<span class="s2">                &lt;!-- Información adicional --&gt;</span>
<span class="s2">                &lt;div class=&quot;info-adicional&quot;&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>
            
            <span class="c1"># Duplicación</span>
            <span class="k">if</span> <span class="n">candidato</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;duplicacion&#39;</span><span class="p">):</span>
                <span class="n">dup</span> <span class="o">=</span> <span class="n">candidato</span><span class="p">[</span><span class="s1">&#39;duplicacion&#39;</span><span class="p">]</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    &lt;div class=&quot;info-card&quot;&gt;</span>
<span class="s2">                        &lt;h5&gt;Duplicación de Código&lt;/h5&gt;</span>
<span class="s2">                        &lt;p&gt;</span><span class="si">{</span><span class="n">dup</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;porcentaje_global&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">%&lt;/p&gt;</span>
<span class="s2">                        &lt;small&gt;</span><span class="si">{</span><span class="n">dup</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bloques_encontrados&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="s2"> bloques duplicados&lt;/small&gt;</span>
<span class="s2">                    &lt;/div&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>
            
            <span class="c1"># Dependencias</span>
            <span class="k">if</span> <span class="n">candidato</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dependencias&#39;</span><span class="p">):</span>
                <span class="n">deps</span> <span class="o">=</span> <span class="n">candidato</span><span class="p">[</span><span class="s1">&#39;dependencias&#39;</span><span class="p">]</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    &lt;div class=&quot;info-card&quot;&gt;</span>
<span class="s2">                        &lt;h5&gt;Dependencias&lt;/h5&gt;</span>
<span class="s2">                        &lt;p&gt;</span><span class="si">{</span><span class="n">deps</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;total_dependencies&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="s2">&lt;/p&gt;</span>
<span class="s2">                        &lt;small&gt;</span><span class="si">{</span><span class="n">deps</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;external_dependencies&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="s2"> externas&lt;/small&gt;</span>
<span class="s2">                    &lt;/div&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>
            
            <span class="c1"># Archivos</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    &lt;div class=&quot;info-card&quot;&gt;</span>
<span class="s2">                        &lt;h5&gt;Archivos Analizados&lt;/h5&gt;</span>
<span class="s2">                        &lt;p&gt;</span><span class="si">{</span><span class="n">candidato</span><span class="p">[</span><span class="s1">&#39;metadata&#39;</span><span class="p">][</span><span class="s1">&#39;archivos_analizados&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&lt;/p&gt;</span>
<span class="s2">                        &lt;small&gt;</span><span class="si">{</span><span class="n">candidato</span><span class="p">[</span><span class="s1">&#39;metadata&#39;</span><span class="p">][</span><span class="s1">&#39;tamano_kb&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> KB total&lt;/small&gt;</span>
<span class="s2">                    &lt;/div&gt;</span>
<span class="s2">                &lt;/div&gt;</span>
<span class="s2">                </span>
<span class="s2">                &lt;div style=&quot;margin-top: 20px;&quot;&gt;</span>
<span class="s2">                    &lt;strong&gt;Lenguajes:&lt;/strong&gt;</span>
<span class="s2">                    &lt;div class=&quot;lenguajes&quot;&gt;</span>
<span class="s2">                        </span><span class="si">{</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;&lt;span class=&quot;lenguaje-tag&quot;&gt;</span><span class="si">{</span><span class="n">lang</span><span class="si">}</span><span class="s1">&lt;/span&gt;&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">lang</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">candidato</span><span class="p">[</span><span class="s1">&#39;lenguajes&#39;</span><span class="p">]])</span><span class="si">}</span>
<span class="s2">                    &lt;/div&gt;</span>
<span class="s2">                &lt;/div&gt;</span>
<span class="s2">            &lt;/div&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>
        
        <span class="n">html</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        &lt;div class=&quot;footer&quot;&gt;</span>
<span class="s2">            &lt;p&gt;Generado por Code Empathizer v2.0 - R. Benítez | </span>
<span class="s2">            &lt;a href=&quot;https://github.com/686f6c61/Repo-Code-Empathizer&quot;&gt;GitHub&lt;/a&gt;&lt;/p&gt;</span>
<span class="s2">        &lt;/div&gt;</span>
<span class="s2">    &lt;/div&gt;</span>
<span class="s2">    </span>
<span class="s2">    &lt;script&gt;</span>
<span class="s2">        // Gráfico comparativo</span>
<span class="s2">        const ctx = document.getElementById(&#39;comparisonChart&#39;).getContext(&#39;2d&#39;);</span>
<span class="s2">        </span>
<span class="s2">        const data = {</span>
<span class="s2">            labels: &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">categorias_labels</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;,</span>
<span class="s2">            datasets: [</span>
<span class="s2">&quot;&quot;&quot;</span>
        
        <span class="c1"># Agregar datasets para cada candidato</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rgba(0, 0, 0, 0.8)&#39;</span><span class="p">,</span> <span class="s1">&#39;rgba(100, 100, 100, 0.8)&#39;</span><span class="p">,</span> <span class="s1">&#39;rgba(150, 150, 150, 0.8)&#39;</span><span class="p">,</span> <span class="s1">&#39;rgba(200, 200, 200, 0.8)&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">candidato</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">candidatos</span><span class="p">):</span>
            <span class="n">scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">candidato</span><span class="p">[</span><span class="s1">&#39;category_scores&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cat</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">categorias</span><span class="p">]</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="se">{{</span>
<span class="s2">                    label: &#39;</span><span class="si">{</span><span class="n">candidato</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;,</span>
<span class="s2">                    data: </span><span class="si">{</span><span class="n">scores</span><span class="si">}</span><span class="s2">,</span>
<span class="s2">                    backgroundColor: &#39;</span><span class="si">{</span><span class="n">colors</span><span class="p">[</span><span class="n">idx</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)]</span><span class="si">}</span><span class="s2">&#39;,</span>
<span class="s2">                    borderColor: &#39;</span><span class="si">{</span><span class="n">colors</span><span class="p">[</span><span class="n">idx</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)]</span><span class="si">}</span><span class="s2">&#39;,</span>
<span class="s2">                    borderWidth: 2</span>
<span class="s2">                </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">&quot;&quot;&quot;</span>
        
        <span class="n">html</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            ]</span>
<span class="s2">        };</span>
<span class="s2">        </span>
<span class="s2">        new Chart(ctx, {</span>
<span class="s2">            type: &#39;bar&#39;,</span>
<span class="s2">            data: data,</span>
<span class="s2">            options: {</span>
<span class="s2">                responsive: true,</span>
<span class="s2">                maintainAspectRatio: false,</span>
<span class="s2">                plugins: {</span>
<span class="s2">                    legend: {</span>
<span class="s2">                        position: &#39;top&#39;,</span>
<span class="s2">                    },</span>
<span class="s2">                    title: {</span>
<span class="s2">                        display: true,</span>
<span class="s2">                        text: &#39;Comparación de Métricas por Categoría&#39;</span>
<span class="s2">                    }</span>
<span class="s2">                },</span>
<span class="s2">                scales: {</span>
<span class="s2">                    y: {</span>
<span class="s2">                        beginAtZero: true,</span>
<span class="s2">                        max: 100,</span>
<span class="s2">                        ticks: {</span>
<span class="s2">                            callback: function(value) {</span>
<span class="s2">                                return value + &#39;%&#39;;</span>
<span class="s2">                            }</span>
<span class="s2">                        }</span>
<span class="s2">                    }</span>
<span class="s2">                }</span>
<span class="s2">            }</span>
<span class="s2">        });</span>
<span class="s2">    &lt;/script&gt;</span>
<span class="s2">&lt;/body&gt;</span>
<span class="s2">&lt;/html&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">html</span>

<div class="viewcode-block" id="Exporter.exportar_graficas_zip">
<a class="viewcode-back" href="../api/exporters.html#exporters.Exporter.exportar_graficas_zip">[documentos]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">exportar_graficas_zip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metricas</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">timestamp</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exporta todas las gráficas generadas en un archivo ZIP.</span>

<span class="sd">        Genera archivos HTML individuales para cada gráfica (radar, barras,</span>
<span class="sd">        comparación por categorías) y los empaqueta en un ZIP para fácil</span>
<span class="sd">        descarga y distribución.</span>

<span class="sd">        Args:</span>
<span class="sd">            metricas: Diccionario con los resultados del análisis.</span>
<span class="sd">            timestamp: Marca de tiempo para el nombre del archivo.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: Ruta al archivo ZIP generado.</span>

<span class="sd">        Raises:</span>
<span class="sd">            IOError: Si no se puede escribir el archivo ZIP.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s1">&#39;export&#39;</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">zip_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;export/graficas_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s1">.zip&#39;</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando ZIP de gráficas: </span><span class="si">{</span><span class="n">zip_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">zip_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZIP_DEFLATED</span><span class="p">)</span> <span class="k">as</span> <span class="n">zipf</span><span class="p">:</span>
                <span class="c1"># Generar gráfica radar</span>
                <span class="n">html_radar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generar_grafica_radar</span><span class="p">(</span><span class="n">metricas</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>
                <span class="n">zipf</span><span class="o">.</span><span class="n">writestr</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;grafica_radar_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s1">.html&#39;</span><span class="p">,</span> <span class="n">html_radar</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Gráfica radar agregada al ZIP&quot;</span><span class="p">)</span>

                <span class="c1"># Generar gráfica de barras</span>
                <span class="n">html_barras</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generar_grafica_barras</span><span class="p">(</span><span class="n">metricas</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>
                <span class="n">zipf</span><span class="o">.</span><span class="n">writestr</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;grafica_barras_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s1">.html&#39;</span><span class="p">,</span> <span class="n">html_barras</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Gráfica de barras agregada al ZIP&quot;</span><span class="p">)</span>

                <span class="c1"># Generar gráfica de comparación por categorías</span>
                <span class="n">html_categorias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generar_grafica_categorias</span><span class="p">(</span><span class="n">metricas</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>
                <span class="n">zipf</span><span class="o">.</span><span class="n">writestr</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;grafica_categorias_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s1">.html&#39;</span><span class="p">,</span> <span class="n">html_categorias</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Gráfica de categorías agregada al ZIP&quot;</span><span class="p">)</span>

                <span class="c1"># Generar gráfica de distribución</span>
                <span class="n">html_distribucion</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generar_grafica_distribucion</span><span class="p">(</span><span class="n">metricas</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>
                <span class="n">zipf</span><span class="o">.</span><span class="n">writestr</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;grafica_distribucion_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s1">.html&#39;</span><span class="p">,</span> <span class="n">html_distribucion</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Gráfica de distribución agregada al ZIP&quot;</span><span class="p">)</span>

                <span class="c1"># Generar gráfica de mapa de calor</span>
                <span class="n">html_heatmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generar_grafica_heatmap</span><span class="p">(</span><span class="n">metricas</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>
                <span class="n">zipf</span><span class="o">.</span><span class="n">writestr</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;grafica_heatmap_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s1">.html&#39;</span><span class="p">,</span> <span class="n">html_heatmap</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Gráfica de mapa de calor agregada al ZIP&quot;</span><span class="p">)</span>

                <span class="c1"># Agregar archivo README con instrucciones</span>
                <span class="n">readme_content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generar_readme_graficas</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
                <span class="n">zipf</span><span class="o">.</span><span class="n">writestr</span><span class="p">(</span><span class="s1">&#39;README.txt&#39;</span><span class="p">,</span> <span class="n">readme_content</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;README agregado al ZIP&quot;</span><span class="p">)</span>

                <span class="c1"># Si hay análisis de equipo, agregar gráficas comparativas</span>
                <span class="k">if</span> <span class="s1">&#39;candidatos&#39;</span> <span class="ow">in</span> <span class="n">metricas</span><span class="p">:</span>
                    <span class="n">html_equipo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generar_grafica_equipo</span><span class="p">(</span><span class="n">metricas</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>
                    <span class="n">zipf</span><span class="o">.</span><span class="n">writestr</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;grafica_equipo_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s1">.html&#39;</span><span class="p">,</span> <span class="n">html_equipo</span><span class="p">)</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Gráfica de equipo agregada al ZIP&quot;</span><span class="p">)</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ZIP de gráficas generado exitosamente: </span><span class="si">{</span><span class="n">zip_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Gráficas exportadas a: </span><span class="si">{</span><span class="n">zip_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">zip_path</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error generando ZIP de gráficas: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_generar_readme_graficas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Genera un archivo README con instrucciones para las gráficas.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;╔══════════════════════════════════════════════════════════════════════╗</span>
<span class="s2">║                                                                      ║</span>
<span class="s2">║              GRÁFICAS DE ANÁLISIS DE EMPATÍA DE CÓDIGO              ║</span>
<span class="s2">║                      Code Empathizer v2.0                            ║</span>
<span class="s2">║                                                                      ║</span>
<span class="s2">╚══════════════════════════════════════════════════════════════════════╝</span>

<span class="s2">CONTENIDO DEL ARCHIVO</span>

<span class="s2">Este archivo ZIP contiene todas las gráficas generadas del análisis de</span>
<span class="s2">empatía de código entre repositorios.</span>

<span class="s2">ARCHIVOS INCLUIDOS:</span>

<span class="s2">1. grafica_radar_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">.html</span>
<span class="s2">   └─ Gráfica tipo radar que muestra la comparación general entre</span>
<span class="s2">      empresa y candidato en todas las categorías</span>

<span class="s2">2. grafica_barras_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">.html</span>
<span class="s2">   └─ Gráfica de barras comparativas por categoría individual</span>

<span class="s2">3. grafica_categorias_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">.html</span>
<span class="s2">   └─ Gráfica detallada de distribución por categorías</span>

<span class="s2">4. grafica_distribucion_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">.html</span>
<span class="s2">   └─ Gráfica de distribución de puntuaciones</span>

<span class="s2">5. grafica_heatmap_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">.html</span>
<span class="s2">   └─ Mapa de calor con comparación visual de todas las categorías</span>

<span class="s2">6. README.txt</span>
<span class="s2">   └─ Este archivo</span>

<span class="s2">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>

<span class="s2">CÓMO USAR LAS GRÁFICAS</span>

<span class="s2">1. Extraer el contenido del ZIP a una carpeta</span>
<span class="s2">2. Abrir cualquier archivo .html en tu navegador web</span>
<span class="s2">3. Las gráficas son interactivas:</span>
<span class="s2">   - Pasar el mouse sobre los puntos para ver valores exactos</span>
<span class="s2">   - Click en la leyenda para ocultar/mostrar series</span>
<span class="s2">   - Las gráficas se ajustan automáticamente al tamaño de la ventana</span>

<span class="s2">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>

<span class="s2">CARACTERÍSTICAS</span>

<span class="s2">• Gráficas interactivas con Chart.js</span>
<span class="s2">• Diseño responsive (se adaptan al tamaño de pantalla)</span>
<span class="s2">• Colores profesionales y accesibles</span>
<span class="s2">• Tooltips informativos</span>
<span class="s2">• Exportables a imagen (click derecho → Guardar imagen)</span>

<span class="s2">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>

<span class="s2">REQUISITOS</span>

<span class="s2">• Navegador web moderno (Chrome, Firefox, Edge, Safari)</span>
<span class="s2">• Conexión a internet (para cargar Chart.js desde CDN)</span>
<span class="s2">• JavaScript habilitado</span>

<span class="s2">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>

<span class="s2">INFORMACIÓN</span>

<span class="s2">Fecha de generación: </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/%m/%Y %H:%M:%S&#39;</span><span class="p">)</span><span class="si">}</span>
<span class="s2">Timestamp: </span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span>
<span class="s2">Herramienta: Code Empathizer v2.0</span>
<span class="s2">Autor: R. Benítez</span>

<span class="s2">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>

<span class="s2">🔗 MÁS INFORMACIÓN</span>

<span class="s2">Repositorio: https://github.com/686f6c61/Repo-Code-Empathizer</span>
<span class="s2">Documentación: Ver README.md en el repositorio principal</span>

<span class="s2">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>

<span class="s2">¡Gracias por usar Code Empathizer!</span>
<span class="s2">&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_generar_grafica_radar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metricas</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">timestamp</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Genera HTML con gráfica radar interactiva.&quot;&quot;&quot;</span>
        <span class="c1"># Extraer datos de empresa y candidato</span>
        <span class="n">empresa_data</span> <span class="o">=</span> <span class="n">metricas</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;repos&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;empresa&#39;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">candidato_data</span> <span class="o">=</span> <span class="n">metricas</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;repos&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;candidato&#39;</span><span class="p">,</span> <span class="p">{})</span>

        <span class="n">categorias</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;nombres&#39;</span><span class="p">,</span> <span class="s1">&#39;documentacion&#39;</span><span class="p">,</span> <span class="s1">&#39;modularidad&#39;</span><span class="p">,</span> <span class="s1">&#39;complejidad&#39;</span><span class="p">,</span>
            <span class="s1">&#39;manejo_errores&#39;</span><span class="p">,</span> <span class="s1">&#39;pruebas&#39;</span><span class="p">,</span> <span class="s1">&#39;seguridad&#39;</span><span class="p">,</span> <span class="s1">&#39;consistencia_estilo&#39;</span>
        <span class="p">]</span>

        <span class="n">empresa_scores</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">candidato_scores</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">categorias</span><span class="p">:</span>
            <span class="n">emp_score</span> <span class="o">=</span> <span class="n">empresa_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cat</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;score&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">cand_score</span> <span class="o">=</span> <span class="n">candidato_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cat</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;score&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">empresa_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">emp_score</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="n">emp_score</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">candidato_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">cand_score</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="n">cand_score</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">categorias_labels</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;NOMBRES&#39;</span><span class="p">,</span> <span class="s1">&#39;DOCUMENTACIÓN&#39;</span><span class="p">,</span> <span class="s1">&#39;MODULARIDAD&#39;</span><span class="p">,</span> <span class="s1">&#39;COMPLEJIDAD&#39;</span><span class="p">,</span>
            <span class="s1">&#39;MANEJO ERRORES&#39;</span><span class="p">,</span> <span class="s1">&#39;PRUEBAS&#39;</span><span class="p">,</span> <span class="s1">&#39;SEGURIDAD&#39;</span><span class="p">,</span> <span class="s1">&#39;CONSISTENCIA&#39;</span>
        <span class="p">]</span>

        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;&lt;!DOCTYPE html&gt;</span>
<span class="s2">&lt;html lang=&quot;es&quot;&gt;</span>
<span class="s2">&lt;head&gt;</span>
<span class="s2">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span>
<span class="s2">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span>
<span class="s2">    &lt;title&gt;GRÁFICA RADAR - ANÁLISIS DE EMPATÍA&lt;/title&gt;</span>
<span class="s2">    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js&quot;&gt;&lt;/script&gt;</span>
<span class="s2">    &lt;style&gt;</span>
<span class="s2">        * </span><span class="se">{{</span>
<span class="s2">            margin: 0;</span>
<span class="s2">            padding: 0;</span>
<span class="s2">            box-sizing: border-box;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        body </span><span class="se">{{</span>
<span class="s2">            font-family: &#39;Segoe UI&#39;, Tahoma, Geneva, Verdana, sans-serif;</span>
<span class="s2">            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);</span>
<span class="s2">            min-height: 100vh;</span>
<span class="s2">            display: flex;</span>
<span class="s2">            flex-direction: column;</span>
<span class="s2">            align-items: center;</span>
<span class="s2">            padding: 20px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .container </span><span class="se">{{</span>
<span class="s2">            background: white;</span>
<span class="s2">            border-radius: 20px;</span>
<span class="s2">            box-shadow: 0 20px 60px rgba(0,0,0,0.3);</span>
<span class="s2">            padding: 30px;</span>
<span class="s2">            max-width: 900px;</span>
<span class="s2">            width: 100%;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        h1 </span><span class="se">{{</span>
<span class="s2">            color: #333;</span>
<span class="s2">            text-align: center;</span>
<span class="s2">            margin-bottom: 10px;</span>
<span class="s2">            font-size: 28px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .subtitle </span><span class="se">{{</span>
<span class="s2">            text-align: center;</span>
<span class="s2">            color: #666;</span>
<span class="s2">            margin-bottom: 30px;</span>
<span class="s2">            font-size: 14px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .chart-container </span><span class="se">{{</span>
<span class="s2">            position: relative;</span>
<span class="s2">            height: 500px;</span>
<span class="s2">            margin: 20px 0;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .info </span><span class="se">{{</span>
<span class="s2">            background: #f8f9fa;</span>
<span class="s2">            border-left: 4px solid #667eea;</span>
<span class="s2">            padding: 15px;</span>
<span class="s2">            margin-top: 20px;</span>
<span class="s2">            border-radius: 5px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .info h3 </span><span class="se">{{</span>
<span class="s2">            color: #667eea;</span>
<span class="s2">            margin-bottom: 10px;</span>
<span class="s2">            font-size: 16px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .info p </span><span class="se">{{</span>
<span class="s2">            color: #666;</span>
<span class="s2">            font-size: 14px;</span>
<span class="s2">            line-height: 1.6;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .footer </span><span class="se">{{</span>
<span class="s2">            text-align: center;</span>
<span class="s2">            color: white;</span>
<span class="s2">            margin-top: 20px;</span>
<span class="s2">            font-size: 12px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">    &lt;/style&gt;</span>
<span class="s2">&lt;/head&gt;</span>
<span class="s2">&lt;body&gt;</span>
<span class="s2">    &lt;div class=&quot;container&quot;&gt;</span>
<span class="s2">        &lt;h1&gt;GRÁFICA RADAR - ANÁLISIS DE EMPATÍA&lt;/h1&gt;</span>
<span class="s2">        &lt;p class=&quot;subtitle&quot;&gt;COMPARACIÓN DE MÉTRICAS ENTRE EMPRESA Y CANDIDATO&lt;/p&gt;</span>

<span class="s2">        &lt;div class=&quot;chart-container&quot;&gt;</span>
<span class="s2">            &lt;canvas id=&quot;radarChart&quot;&gt;&lt;/canvas&gt;</span>
<span class="s2">        &lt;/div&gt;</span>

<span class="s2">        &lt;div class=&quot;info&quot;&gt;</span>
<span class="s2">            &lt;h3&gt;Cómo interpretar esta gráfica&lt;/h3&gt;</span>
<span class="s2">            &lt;p&gt;</span>
<span class="s2">                La gráfica radar muestra la comparación de 8 categorías de análisis de código.</span>
<span class="s2">                Cuanto más cerca del borde exterior, mejor es la puntuación (máximo 100).</span>
<span class="s2">                &lt;br&gt;&lt;br&gt;</span>
<span class="s2">                &lt;strong&gt;• Línea azul:&lt;/strong&gt; Repositorio de la Empresa (Master)&lt;br&gt;</span>
<span class="s2">                &lt;strong&gt;• Línea naranja:&lt;/strong&gt; Repositorio del Candidato&lt;br&gt;</span>
<span class="s2">                &lt;br&gt;</span>
<span class="s2">                Una mayor superposición entre ambas líneas indica mayor empatía de código.</span>
<span class="s2">            &lt;/p&gt;</span>
<span class="s2">        &lt;/div&gt;</span>
<span class="s2">    &lt;/div&gt;</span>

<span class="s2">    &lt;div class=&quot;footer&quot;&gt;</span>
<span class="s2">        Generado el </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/%m/%Y %H:%M:%S&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> | Code Empathizer v2.0</span>
<span class="s2">    &lt;/div&gt;</span>

<span class="s2">    &lt;script&gt;</span>
<span class="s2">        const ctx = document.getElementById(&#39;radarChart&#39;).getContext(&#39;2d&#39;);</span>
<span class="s2">        new Chart(ctx, </span><span class="se">{{</span>
<span class="s2">            type: &#39;radar&#39;,</span>
<span class="s2">            data: </span><span class="se">{{</span>
<span class="s2">                labels: </span><span class="si">{</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">categorias_labels</span><span class="p">)</span><span class="si">}</span><span class="s2">,</span>
<span class="s2">                datasets: [</span>
<span class="s2">                    </span><span class="se">{{</span>
<span class="s2">                        label: &#39;Empresa (Master)&#39;,</span>
<span class="s2">                        data: </span><span class="si">{</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">empresa_scores</span><span class="p">)</span><span class="si">}</span><span class="s2">,</span>
<span class="s2">                        backgroundColor: &#39;rgba(54, 162, 235, 0.2)&#39;,</span>
<span class="s2">                        borderColor: &#39;rgba(54, 162, 235, 1)&#39;,</span>
<span class="s2">                        borderWidth: 2,</span>
<span class="s2">                        pointBackgroundColor: &#39;rgba(54, 162, 235, 1)&#39;,</span>
<span class="s2">                        pointBorderColor: &#39;#fff&#39;,</span>
<span class="s2">                        pointHoverBackgroundColor: &#39;#fff&#39;,</span>
<span class="s2">                        pointHoverBorderColor: &#39;rgba(54, 162, 235, 1)&#39;,</span>
<span class="s2">                        pointRadius: 4,</span>
<span class="s2">                        pointHoverRadius: 6</span>
<span class="s2">                    </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                    </span><span class="se">{{</span>
<span class="s2">                        label: &#39;Candidato&#39;,</span>
<span class="s2">                        data: </span><span class="si">{</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">candidato_scores</span><span class="p">)</span><span class="si">}</span><span class="s2">,</span>
<span class="s2">                        backgroundColor: &#39;rgba(255, 159, 64, 0.2)&#39;,</span>
<span class="s2">                        borderColor: &#39;rgba(255, 159, 64, 1)&#39;,</span>
<span class="s2">                        borderWidth: 2,</span>
<span class="s2">                        pointBackgroundColor: &#39;rgba(255, 159, 64, 1)&#39;,</span>
<span class="s2">                        pointBorderColor: &#39;#fff&#39;,</span>
<span class="s2">                        pointHoverBackgroundColor: &#39;#fff&#39;,</span>
<span class="s2">                        pointHoverBorderColor: &#39;rgba(255, 159, 64, 1)&#39;,</span>
<span class="s2">                        pointRadius: 4,</span>
<span class="s2">                        pointHoverRadius: 6</span>
<span class="s2">                    </span><span class="se">}}</span>
<span class="s2">                ]</span>
<span class="s2">            </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">            options: </span><span class="se">{{</span>
<span class="s2">                responsive: true,</span>
<span class="s2">                maintainAspectRatio: false,</span>
<span class="s2">                plugins: </span><span class="se">{{</span>
<span class="s2">                    legend: </span><span class="se">{{</span>
<span class="s2">                        position: &#39;top&#39;,</span>
<span class="s2">                        labels: </span><span class="se">{{</span>
<span class="s2">                            padding: 20,</span>
<span class="s2">                            font: </span><span class="se">{{</span>
<span class="s2">                                size: 14</span>
<span class="s2">                            </span><span class="se">}}</span>
<span class="s2">                        </span><span class="se">}}</span>
<span class="s2">                    </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                    tooltip: </span><span class="se">{{</span>
<span class="s2">                        backgroundColor: &#39;rgba(0, 0, 0, 0.8)&#39;,</span>
<span class="s2">                        titleFont: </span><span class="se">{{</span><span class="s2"> size: 14 </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                        bodyFont: </span><span class="se">{{</span><span class="s2"> size: 13 </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                        padding: 12,</span>
<span class="s2">                        callbacks: </span><span class="se">{{</span>
<span class="s2">                            label: function(context) </span><span class="se">{{</span>
<span class="s2">                                return context.dataset.label + &#39;: &#39; + context.parsed.r.toFixed(2) + &#39;%&#39;;</span>
<span class="s2">                            </span><span class="se">}}</span>
<span class="s2">                        </span><span class="se">}}</span>
<span class="s2">                    </span><span class="se">}}</span>
<span class="s2">                </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                scales: </span><span class="se">{{</span>
<span class="s2">                    r: </span><span class="se">{{</span>
<span class="s2">                        beginAtZero: true,</span>
<span class="s2">                        max: 100,</span>
<span class="s2">                        ticks: </span><span class="se">{{</span>
<span class="s2">                            stepSize: 20,</span>
<span class="s2">                            callback: function(value) </span><span class="se">{{</span>
<span class="s2">                                return value + &#39;%&#39;;</span>
<span class="s2">                            </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                            font: </span><span class="se">{{</span><span class="s2"> size: 12 </span><span class="se">}}</span>
<span class="s2">                        </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                        pointLabels: </span><span class="se">{{</span>
<span class="s2">                            font: </span><span class="se">{{</span><span class="s2"> size: 13 </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                            color: &#39;#333&#39;</span>
<span class="s2">                        </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                        grid: </span><span class="se">{{</span>
<span class="s2">                            color: &#39;rgba(0, 0, 0, 0.1)&#39;</span>
<span class="s2">                        </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                        angleLines: </span><span class="se">{{</span>
<span class="s2">                            color: &#39;rgba(0, 0, 0, 0.1)&#39;</span>
<span class="s2">                        </span><span class="se">}}</span>
<span class="s2">                    </span><span class="se">}}</span>
<span class="s2">                </span><span class="se">}}</span>
<span class="s2">            </span><span class="se">}}</span>
<span class="s2">        </span><span class="se">}}</span><span class="s2">);</span>
<span class="s2">    &lt;/script&gt;</span>
<span class="s2">&lt;/body&gt;</span>
<span class="s2">&lt;/html&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_generar_grafica_barras</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metricas</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">timestamp</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Genera HTML con gráfica de barras comparativa.&quot;&quot;&quot;</span>
        <span class="n">empresa_data</span> <span class="o">=</span> <span class="n">metricas</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;repos&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;empresa&#39;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">candidato_data</span> <span class="o">=</span> <span class="n">metricas</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;repos&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;candidato&#39;</span><span class="p">,</span> <span class="p">{})</span>

        <span class="n">categorias</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;nombres&#39;</span><span class="p">,</span> <span class="s1">&#39;documentacion&#39;</span><span class="p">,</span> <span class="s1">&#39;modularidad&#39;</span><span class="p">,</span> <span class="s1">&#39;complejidad&#39;</span><span class="p">,</span>
            <span class="s1">&#39;manejo_errores&#39;</span><span class="p">,</span> <span class="s1">&#39;pruebas&#39;</span><span class="p">,</span> <span class="s1">&#39;seguridad&#39;</span><span class="p">,</span> <span class="s1">&#39;consistencia_estilo&#39;</span>
        <span class="p">]</span>

        <span class="n">empresa_scores</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">candidato_scores</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">categorias</span><span class="p">:</span>
            <span class="n">emp_score</span> <span class="o">=</span> <span class="n">empresa_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cat</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;score&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">cand_score</span> <span class="o">=</span> <span class="n">candidato_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cat</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;score&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">empresa_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">emp_score</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="n">emp_score</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">candidato_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">cand_score</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="n">cand_score</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">categorias_labels</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;NOMBRES&#39;</span><span class="p">,</span> <span class="s1">&#39;DOCUMENTACIÓN&#39;</span><span class="p">,</span> <span class="s1">&#39;MODULARIDAD&#39;</span><span class="p">,</span> <span class="s1">&#39;COMPLEJIDAD&#39;</span><span class="p">,</span>
            <span class="s1">&#39;MANEJO ERRORES&#39;</span><span class="p">,</span> <span class="s1">&#39;PRUEBAS&#39;</span><span class="p">,</span> <span class="s1">&#39;SEGURIDAD&#39;</span><span class="p">,</span> <span class="s1">&#39;CONSISTENCIA&#39;</span>
        <span class="p">]</span>

        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;&lt;!DOCTYPE html&gt;</span>
<span class="s2">&lt;html lang=&quot;es&quot;&gt;</span>
<span class="s2">&lt;head&gt;</span>
<span class="s2">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span>
<span class="s2">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span>
<span class="s2">    &lt;title&gt;GRÁFICA DE BARRAS - ANÁLISIS DE EMPATÍA&lt;/title&gt;</span>
<span class="s2">    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js&quot;&gt;&lt;/script&gt;</span>
<span class="s2">    &lt;style&gt;</span>
<span class="s2">        * </span><span class="se">{{</span>
<span class="s2">            margin: 0;</span>
<span class="s2">            padding: 0;</span>
<span class="s2">            box-sizing: border-box;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        body </span><span class="se">{{</span>
<span class="s2">            font-family: &#39;Segoe UI&#39;, Tahoma, Geneva, Verdana, sans-serif;</span>
<span class="s2">            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);</span>
<span class="s2">            min-height: 100vh;</span>
<span class="s2">            display: flex;</span>
<span class="s2">            flex-direction: column;</span>
<span class="s2">            align-items: center;</span>
<span class="s2">            padding: 20px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .container </span><span class="se">{{</span>
<span class="s2">            background: white;</span>
<span class="s2">            border-radius: 20px;</span>
<span class="s2">            box-shadow: 0 20px 60px rgba(0,0,0,0.3);</span>
<span class="s2">            padding: 30px;</span>
<span class="s2">            max-width: 1000px;</span>
<span class="s2">            width: 100%;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        h1 </span><span class="se">{{</span>
<span class="s2">            color: #333;</span>
<span class="s2">            text-align: center;</span>
<span class="s2">            margin-bottom: 10px;</span>
<span class="s2">            font-size: 28px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .subtitle </span><span class="se">{{</span>
<span class="s2">            text-align: center;</span>
<span class="s2">            color: #666;</span>
<span class="s2">            margin-bottom: 30px;</span>
<span class="s2">            font-size: 14px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .chart-container </span><span class="se">{{</span>
<span class="s2">            position: relative;</span>
<span class="s2">            height: 500px;</span>
<span class="s2">            margin: 20px 0;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .stats </span><span class="se">{{</span>
<span class="s2">            display: grid;</span>
<span class="s2">            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));</span>
<span class="s2">            gap: 15px;</span>
<span class="s2">            margin-top: 20px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .stat-card </span><span class="se">{{</span>
<span class="s2">            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);</span>
<span class="s2">            padding: 15px;</span>
<span class="s2">            border-radius: 10px;</span>
<span class="s2">            color: white;</span>
<span class="s2">            text-align: center;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .stat-card h3 </span><span class="se">{{</span>
<span class="s2">            font-size: 14px;</span>
<span class="s2">            margin-bottom: 5px;</span>
<span class="s2">            opacity: 0.9;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .stat-card .value </span><span class="se">{{</span>
<span class="s2">            font-size: 24px;</span>
<span class="s2">            font-weight: bold;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .footer </span><span class="se">{{</span>
<span class="s2">            text-align: center;</span>
<span class="s2">            color: white;</span>
<span class="s2">            margin-top: 20px;</span>
<span class="s2">            font-size: 12px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">    &lt;/style&gt;</span>
<span class="s2">&lt;/head&gt;</span>
<span class="s2">&lt;body&gt;</span>
<span class="s2">    &lt;div class=&quot;container&quot;&gt;</span>
<span class="s2">        &lt;h1&gt;GRÁFICA DE BARRAS COMPARATIVA&lt;/h1&gt;</span>
<span class="s2">        &lt;p class=&quot;subtitle&quot;&gt;ANÁLISIS DETALLADO POR CATEGORÍA&lt;/p&gt;</span>

<span class="s2">        &lt;div class=&quot;chart-container&quot;&gt;</span>
<span class="s2">            &lt;canvas id=&quot;barChart&quot;&gt;&lt;/canvas&gt;</span>
<span class="s2">        &lt;/div&gt;</span>

<span class="s2">        &lt;div class=&quot;stats&quot;&gt;</span>
<span class="s2">            &lt;div class=&quot;stat-card&quot;&gt;</span>
<span class="s2">                &lt;h3&gt;Promedio Empresa&lt;/h3&gt;</span>
<span class="s2">                &lt;div class=&quot;value&quot;&gt;</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">empresa_scores</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">empresa_scores</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">empresa_scores</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="si">}</span><span class="s2">%&lt;/div&gt;</span>
<span class="s2">            &lt;/div&gt;</span>
<span class="s2">            &lt;div class=&quot;stat-card&quot;&gt;</span>
<span class="s2">                &lt;h3&gt;Promedio Candidato&lt;/h3&gt;</span>
<span class="s2">                &lt;div class=&quot;value&quot;&gt;</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">candidato_scores</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">candidato_scores</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">candidato_scores</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="si">}</span><span class="s2">%&lt;/div&gt;</span>
<span class="s2">            &lt;/div&gt;</span>
<span class="s2">            &lt;div class=&quot;stat-card&quot;&gt;</span>
<span class="s2">                &lt;h3&gt;Diferencia Media&lt;/h3&gt;</span>
<span class="s2">                &lt;div class=&quot;value&quot;&gt;</span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">empresa_scores</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">empresa_scores</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">candidato_scores</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">candidato_scores</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">empresa_scores</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">candidato_scores</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="si">}</span><span class="s2">%&lt;/div&gt;</span>
<span class="s2">            &lt;/div&gt;</span>
<span class="s2">        &lt;/div&gt;</span>
<span class="s2">    &lt;/div&gt;</span>

<span class="s2">    &lt;div class=&quot;footer&quot;&gt;</span>
<span class="s2">        Generado el </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/%m/%Y %H:%M:%S&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> | Code Empathizer v2.0</span>
<span class="s2">    &lt;/div&gt;</span>

<span class="s2">    &lt;script&gt;</span>
<span class="s2">        const ctx = document.getElementById(&#39;barChart&#39;).getContext(&#39;2d&#39;);</span>
<span class="s2">        new Chart(ctx, </span><span class="se">{{</span>
<span class="s2">            type: &#39;bar&#39;,</span>
<span class="s2">            data: </span><span class="se">{{</span>
<span class="s2">                labels: </span><span class="si">{</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">categorias_labels</span><span class="p">)</span><span class="si">}</span><span class="s2">,</span>
<span class="s2">                datasets: [</span>
<span class="s2">                    </span><span class="se">{{</span>
<span class="s2">                        label: &#39;Empresa (Master)&#39;,</span>
<span class="s2">                        data: </span><span class="si">{</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">empresa_scores</span><span class="p">)</span><span class="si">}</span><span class="s2">,</span>
<span class="s2">                        backgroundColor: &#39;rgba(54, 162, 235, 0.8)&#39;,</span>
<span class="s2">                        borderColor: &#39;rgba(54, 162, 235, 1)&#39;,</span>
<span class="s2">                        borderWidth: 2,</span>
<span class="s2">                        borderRadius: 5</span>
<span class="s2">                    </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                    </span><span class="se">{{</span>
<span class="s2">                        label: &#39;Candidato&#39;,</span>
<span class="s2">                        data: </span><span class="si">{</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">candidato_scores</span><span class="p">)</span><span class="si">}</span><span class="s2">,</span>
<span class="s2">                        backgroundColor: &#39;rgba(255, 159, 64, 0.8)&#39;,</span>
<span class="s2">                        borderColor: &#39;rgba(255, 159, 64, 1)&#39;,</span>
<span class="s2">                        borderWidth: 2,</span>
<span class="s2">                        borderRadius: 5</span>
<span class="s2">                    </span><span class="se">}}</span>
<span class="s2">                ]</span>
<span class="s2">            </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">            options: </span><span class="se">{{</span>
<span class="s2">                responsive: true,</span>
<span class="s2">                maintainAspectRatio: false,</span>
<span class="s2">                plugins: </span><span class="se">{{</span>
<span class="s2">                    legend: </span><span class="se">{{</span>
<span class="s2">                        position: &#39;top&#39;,</span>
<span class="s2">                        labels: </span><span class="se">{{</span>
<span class="s2">                            padding: 20,</span>
<span class="s2">                            font: </span><span class="se">{{</span><span class="s2"> size: 14 </span><span class="se">}}</span>
<span class="s2">                        </span><span class="se">}}</span>
<span class="s2">                    </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                    tooltip: </span><span class="se">{{</span>
<span class="s2">                        backgroundColor: &#39;rgba(0, 0, 0, 0.8)&#39;,</span>
<span class="s2">                        titleFont: </span><span class="se">{{</span><span class="s2"> size: 14 </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                        bodyFont: </span><span class="se">{{</span><span class="s2"> size: 13 </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                        padding: 12,</span>
<span class="s2">                        callbacks: </span><span class="se">{{</span>
<span class="s2">                            label: function(context) </span><span class="se">{{</span>
<span class="s2">                                return context.dataset.label + &#39;: &#39; + context.parsed.y.toFixed(2) + &#39;%&#39;;</span>
<span class="s2">                            </span><span class="se">}}</span>
<span class="s2">                        </span><span class="se">}}</span>
<span class="s2">                    </span><span class="se">}}</span>
<span class="s2">                </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                scales: </span><span class="se">{{</span>
<span class="s2">                    y: </span><span class="se">{{</span>
<span class="s2">                        beginAtZero: true,</span>
<span class="s2">                        max: 100,</span>
<span class="s2">                        ticks: </span><span class="se">{{</span>
<span class="s2">                            stepSize: 10,</span>
<span class="s2">                            callback: function(value) </span><span class="se">{{</span>
<span class="s2">                                return value + &#39;%&#39;;</span>
<span class="s2">                            </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                            font: </span><span class="se">{{</span><span class="s2"> size: 12 </span><span class="se">}}</span>
<span class="s2">                        </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                        grid: </span><span class="se">{{</span>
<span class="s2">                            color: &#39;rgba(0, 0, 0, 0.05)&#39;</span>
<span class="s2">                        </span><span class="se">}}</span>
<span class="s2">                    </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                    x: </span><span class="se">{{</span>
<span class="s2">                        grid: </span><span class="se">{{</span>
<span class="s2">                            display: false</span>
<span class="s2">                        </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                        ticks: </span><span class="se">{{</span>
<span class="s2">                            font: </span><span class="se">{{</span><span class="s2"> size: 12 </span><span class="se">}}</span>
<span class="s2">                        </span><span class="se">}}</span>
<span class="s2">                    </span><span class="se">}}</span>
<span class="s2">                </span><span class="se">}}</span>
<span class="s2">            </span><span class="se">}}</span>
<span class="s2">        </span><span class="se">}}</span><span class="s2">);</span>
<span class="s2">    &lt;/script&gt;</span>
<span class="s2">&lt;/body&gt;</span>
<span class="s2">&lt;/html&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_generar_grafica_categorias</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metricas</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">timestamp</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Genera HTML con gráfica de líneas por categorías.&quot;&quot;&quot;</span>
        <span class="n">empresa_data</span> <span class="o">=</span> <span class="n">metricas</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;repos&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;empresa&#39;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">candidato_data</span> <span class="o">=</span> <span class="n">metricas</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;repos&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;candidato&#39;</span><span class="p">,</span> <span class="p">{})</span>

        <span class="n">categorias</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;nombres&#39;</span><span class="p">,</span> <span class="s1">&#39;documentacion&#39;</span><span class="p">,</span> <span class="s1">&#39;modularidad&#39;</span><span class="p">,</span> <span class="s1">&#39;complejidad&#39;</span><span class="p">,</span>
            <span class="s1">&#39;manejo_errores&#39;</span><span class="p">,</span> <span class="s1">&#39;pruebas&#39;</span><span class="p">,</span> <span class="s1">&#39;seguridad&#39;</span><span class="p">,</span> <span class="s1">&#39;consistencia_estilo&#39;</span>
        <span class="p">]</span>

        <span class="n">empresa_scores</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">candidato_scores</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">diferencias</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">categorias</span><span class="p">:</span>
            <span class="n">emp_score</span> <span class="o">=</span> <span class="n">empresa_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cat</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;score&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">cand_score</span> <span class="o">=</span> <span class="n">candidato_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cat</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;score&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">emp_pct</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">emp_score</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="n">emp_score</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="n">cand_pct</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">cand_score</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="n">cand_score</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="n">empresa_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">emp_pct</span><span class="p">)</span>
            <span class="n">candidato_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cand_pct</span><span class="p">)</span>
            <span class="n">diferencias</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">emp_pct</span> <span class="o">-</span> <span class="n">cand_pct</span><span class="p">))</span>

        <span class="n">categorias_labels</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;NOMBRES&#39;</span><span class="p">,</span> <span class="s1">&#39;DOCUMENTACIÓN&#39;</span><span class="p">,</span> <span class="s1">&#39;MODULARIDAD&#39;</span><span class="p">,</span> <span class="s1">&#39;COMPLEJIDAD&#39;</span><span class="p">,</span>
            <span class="s1">&#39;MANEJO ERRORES&#39;</span><span class="p">,</span> <span class="s1">&#39;PRUEBAS&#39;</span><span class="p">,</span> <span class="s1">&#39;SEGURIDAD&#39;</span><span class="p">,</span> <span class="s1">&#39;CONSISTENCIA&#39;</span>
        <span class="p">]</span>

        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;&lt;!DOCTYPE html&gt;</span>
<span class="s2">&lt;html lang=&quot;es&quot;&gt;</span>
<span class="s2">&lt;head&gt;</span>
<span class="s2">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span>
<span class="s2">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span>
<span class="s2">    &lt;title&gt;ANÁLISIS POR CATEGORÍAS&lt;/title&gt;</span>
<span class="s2">    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js&quot;&gt;&lt;/script&gt;</span>
<span class="s2">    &lt;style&gt;</span>
<span class="s2">        * </span><span class="se">{{</span>
<span class="s2">            margin: 0;</span>
<span class="s2">            padding: 0;</span>
<span class="s2">            box-sizing: border-box;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        body </span><span class="se">{{</span>
<span class="s2">            font-family: &#39;Segoe UI&#39;, Tahoma, Geneva, Verdana, sans-serif;</span>
<span class="s2">            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);</span>
<span class="s2">            min-height: 100vh;</span>
<span class="s2">            display: flex;</span>
<span class="s2">            flex-direction: column;</span>
<span class="s2">            align-items: center;</span>
<span class="s2">            padding: 20px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .container </span><span class="se">{{</span>
<span class="s2">            background: white;</span>
<span class="s2">            border-radius: 20px;</span>
<span class="s2">            box-shadow: 0 20px 60px rgba(0,0,0,0.3);</span>
<span class="s2">            padding: 30px;</span>
<span class="s2">            max-width: 1100px;</span>
<span class="s2">            width: 100%;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        h1 </span><span class="se">{{</span>
<span class="s2">            color: #333;</span>
<span class="s2">            text-align: center;</span>
<span class="s2">            margin-bottom: 10px;</span>
<span class="s2">            font-size: 28px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .subtitle </span><span class="se">{{</span>
<span class="s2">            text-align: center;</span>
<span class="s2">            color: #666;</span>
<span class="s2">            margin-bottom: 30px;</span>
<span class="s2">            font-size: 14px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .chart-container </span><span class="se">{{</span>
<span class="s2">            position: relative;</span>
<span class="s2">            height: 450px;</span>
<span class="s2">            margin: 20px 0;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .footer </span><span class="se">{{</span>
<span class="s2">            text-align: center;</span>
<span class="s2">            color: white;</span>
<span class="s2">            margin-top: 20px;</span>
<span class="s2">            font-size: 12px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">    &lt;/style&gt;</span>
<span class="s2">&lt;/head&gt;</span>
<span class="s2">&lt;body&gt;</span>
<span class="s2">    &lt;div class=&quot;container&quot;&gt;</span>
<span class="s2">        &lt;h1&gt;ANÁLISIS DETALLADO POR CATEGORÍAS&lt;/h1&gt;</span>
<span class="s2">        &lt;p class=&quot;subtitle&quot;&gt;EVOLUCIÓN DE MÉTRICAS Y DIFERENCIAS&lt;/p&gt;</span>

<span class="s2">        &lt;div class=&quot;chart-container&quot;&gt;</span>
<span class="s2">            &lt;canvas id=&quot;lineChart&quot;&gt;&lt;/canvas&gt;</span>
<span class="s2">        &lt;/div&gt;</span>
<span class="s2">    &lt;/div&gt;</span>

<span class="s2">    &lt;div class=&quot;footer&quot;&gt;</span>
<span class="s2">        Generado el </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/%m/%Y %H:%M:%S&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> | Code Empathizer v2.0</span>
<span class="s2">    &lt;/div&gt;</span>

<span class="s2">    &lt;script&gt;</span>
<span class="s2">        const ctx = document.getElementById(&#39;lineChart&#39;).getContext(&#39;2d&#39;);</span>
<span class="s2">        new Chart(ctx, </span><span class="se">{{</span>
<span class="s2">            type: &#39;line&#39;,</span>
<span class="s2">            data: </span><span class="se">{{</span>
<span class="s2">                labels: </span><span class="si">{</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">categorias_labels</span><span class="p">)</span><span class="si">}</span><span class="s2">,</span>
<span class="s2">                datasets: [</span>
<span class="s2">                    </span><span class="se">{{</span>
<span class="s2">                        label: &#39;Empresa&#39;,</span>
<span class="s2">                        data: </span><span class="si">{</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">empresa_scores</span><span class="p">)</span><span class="si">}</span><span class="s2">,</span>
<span class="s2">                        borderColor: &#39;rgba(54, 162, 235, 1)&#39;,</span>
<span class="s2">                        backgroundColor: &#39;rgba(54, 162, 235, 0.1)&#39;,</span>
<span class="s2">                        borderWidth: 3,</span>
<span class="s2">                        fill: true,</span>
<span class="s2">                        tension: 0.4,</span>
<span class="s2">                        pointRadius: 5,</span>
<span class="s2">                        pointHoverRadius: 7</span>
<span class="s2">                    </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                    </span><span class="se">{{</span>
<span class="s2">                        label: &#39;Candidato&#39;,</span>
<span class="s2">                        data: </span><span class="si">{</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">candidato_scores</span><span class="p">)</span><span class="si">}</span><span class="s2">,</span>
<span class="s2">                        borderColor: &#39;rgba(255, 159, 64, 1)&#39;,</span>
<span class="s2">                        backgroundColor: &#39;rgba(255, 159, 64, 0.1)&#39;,</span>
<span class="s2">                        borderWidth: 3,</span>
<span class="s2">                        fill: true,</span>
<span class="s2">                        tension: 0.4,</span>
<span class="s2">                        pointRadius: 5,</span>
<span class="s2">                        pointHoverRadius: 7</span>
<span class="s2">                    </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                    </span><span class="se">{{</span>
<span class="s2">                        label: &#39;Diferencia&#39;,</span>
<span class="s2">                        data: </span><span class="si">{</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">diferencias</span><span class="p">)</span><span class="si">}</span><span class="s2">,</span>
<span class="s2">                        borderColor: &#39;rgba(255, 99, 132, 1)&#39;,</span>
<span class="s2">                        backgroundColor: &#39;rgba(255, 99, 132, 0.1)&#39;,</span>
<span class="s2">                        borderWidth: 2,</span>
<span class="s2">                        borderDash: [5, 5],</span>
<span class="s2">                        fill: false,</span>
<span class="s2">                        tension: 0.4,</span>
<span class="s2">                        pointRadius: 4,</span>
<span class="s2">                        pointHoverRadius: 6</span>
<span class="s2">                    </span><span class="se">}}</span>
<span class="s2">                ]</span>
<span class="s2">            </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">            options: </span><span class="se">{{</span>
<span class="s2">                responsive: true,</span>
<span class="s2">                maintainAspectRatio: false,</span>
<span class="s2">                plugins: </span><span class="se">{{</span>
<span class="s2">                    legend: </span><span class="se">{{</span>
<span class="s2">                        position: &#39;top&#39;,</span>
<span class="s2">                        labels: </span><span class="se">{{</span>
<span class="s2">                            padding: 20,</span>
<span class="s2">                            font: </span><span class="se">{{</span><span class="s2"> size: 14 </span><span class="se">}}</span>
<span class="s2">                        </span><span class="se">}}</span>
<span class="s2">                    </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                    tooltip: </span><span class="se">{{</span>
<span class="s2">                        mode: &#39;index&#39;,</span>
<span class="s2">                        intersect: false,</span>
<span class="s2">                        backgroundColor: &#39;rgba(0, 0, 0, 0.8)&#39;,</span>
<span class="s2">                        titleFont: </span><span class="se">{{</span><span class="s2"> size: 14 </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                        bodyFont: </span><span class="se">{{</span><span class="s2"> size: 13 </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                        padding: 12</span>
<span class="s2">                    </span><span class="se">}}</span>
<span class="s2">                </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                scales: </span><span class="se">{{</span>
<span class="s2">                    y: </span><span class="se">{{</span>
<span class="s2">                        beginAtZero: true,</span>
<span class="s2">                        max: 100,</span>
<span class="s2">                        ticks: </span><span class="se">{{</span>
<span class="s2">                            callback: function(value) </span><span class="se">{{</span>
<span class="s2">                                return value + &#39;%&#39;;</span>
<span class="s2">                            </span><span class="se">}}</span>
<span class="s2">                        </span><span class="se">}}</span>
<span class="s2">                    </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                    x: </span><span class="se">{{</span>
<span class="s2">                        grid: </span><span class="se">{{</span>
<span class="s2">                            display: false</span>
<span class="s2">                        </span><span class="se">}}</span>
<span class="s2">                    </span><span class="se">}}</span>
<span class="s2">                </span><span class="se">}}</span>
<span class="s2">            </span><span class="se">}}</span>
<span class="s2">        </span><span class="se">}}</span><span class="s2">);</span>
<span class="s2">    &lt;/script&gt;</span>
<span class="s2">&lt;/body&gt;</span>
<span class="s2">&lt;/html&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_generar_grafica_distribucion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metricas</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">timestamp</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Genera HTML con gráfica de distribución de puntuaciones.&quot;&quot;&quot;</span>
        <span class="n">empresa_data</span> <span class="o">=</span> <span class="n">metricas</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;repos&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;empresa&#39;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">candidato_data</span> <span class="o">=</span> <span class="n">metricas</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;repos&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;candidato&#39;</span><span class="p">,</span> <span class="p">{})</span>

        <span class="c1"># Obtener score de empatía si existe</span>
        <span class="n">empathy_score</span> <span class="o">=</span> <span class="n">metricas</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;empathy_analysis&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;overall_score&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;&lt;!DOCTYPE html&gt;</span>
<span class="s2">&lt;html lang=&quot;es&quot;&gt;</span>
<span class="s2">&lt;head&gt;</span>
<span class="s2">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span>
<span class="s2">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span>
<span class="s2">    &lt;title&gt;DISTRIBUCIÓN DE PUNTUACIONES&lt;/title&gt;</span>
<span class="s2">    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js&quot;&gt;&lt;/script&gt;</span>
<span class="s2">    &lt;style&gt;</span>
<span class="s2">        * </span><span class="se">{{</span>
<span class="s2">            margin: 0;</span>
<span class="s2">            padding: 0;</span>
<span class="s2">            box-sizing: border-box;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        body </span><span class="se">{{</span>
<span class="s2">            font-family: &#39;Segoe UI&#39;, Tahoma, Geneva, Verdana, sans-serif;</span>
<span class="s2">            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);</span>
<span class="s2">            min-height: 100vh;</span>
<span class="s2">            display: flex;</span>
<span class="s2">            flex-direction: column;</span>
<span class="s2">            align-items: center;</span>
<span class="s2">            padding: 20px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .container </span><span class="se">{{</span>
<span class="s2">            background: white;</span>
<span class="s2">            border-radius: 20px;</span>
<span class="s2">            box-shadow: 0 20px 60px rgba(0,0,0,0.3);</span>
<span class="s2">            padding: 30px;</span>
<span class="s2">            max-width: 900px;</span>
<span class="s2">            width: 100%;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        h1 </span><span class="se">{{</span>
<span class="s2">            color: #333;</span>
<span class="s2">            text-align: center;</span>
<span class="s2">            margin-bottom: 10px;</span>
<span class="s2">            font-size: 28px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .subtitle </span><span class="se">{{</span>
<span class="s2">            text-align: center;</span>
<span class="s2">            color: #666;</span>
<span class="s2">            margin-bottom: 30px;</span>
<span class="s2">            font-size: 14px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .chart-container </span><span class="se">{{</span>
<span class="s2">            position: relative;</span>
<span class="s2">            height: 400px;</span>
<span class="s2">            margin: 20px 0;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .empathy-score </span><span class="se">{{</span>
<span class="s2">            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);</span>
<span class="s2">            padding: 20px;</span>
<span class="s2">            border-radius: 15px;</span>
<span class="s2">            text-align: center;</span>
<span class="s2">            color: white;</span>
<span class="s2">            margin-top: 20px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .empathy-score h2 </span><span class="se">{{</span>
<span class="s2">            font-size: 18px;</span>
<span class="s2">            margin-bottom: 10px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .empathy-score .score </span><span class="se">{{</span>
<span class="s2">            font-size: 48px;</span>
<span class="s2">            font-weight: bold;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .footer </span><span class="se">{{</span>
<span class="s2">            text-align: center;</span>
<span class="s2">            color: #333;</span>
<span class="s2">            margin-top: 20px;</span>
<span class="s2">            font-size: 12px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">    &lt;/style&gt;</span>
<span class="s2">&lt;/head&gt;</span>
<span class="s2">&lt;body&gt;</span>
<span class="s2">    &lt;div class=&quot;container&quot;&gt;</span>
<span class="s2">        &lt;h1&gt;DISTRIBUCIÓN DE PUNTUACIONES&lt;/h1&gt;</span>
<span class="s2">        &lt;p class=&quot;subtitle&quot;&gt;VISTA GENERAL DE CALIDAD DE CÓDIGO&lt;/p&gt;</span>

<span class="s2">        &lt;div class=&quot;chart-container&quot;&gt;</span>
<span class="s2">            &lt;canvas id=&quot;doughnutChart&quot;&gt;&lt;/canvas&gt;</span>
<span class="s2">        &lt;/div&gt;</span>

<span class="s2">        &lt;div class=&quot;empathy-score&quot;&gt;</span>
<span class="s2">            &lt;h2&gt;SCORE DE EMPATÍA GLOBAL&lt;/h2&gt;</span>
<span class="s2">            &lt;div class=&quot;score&quot;&gt;</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">empathy_score</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">%&lt;/div&gt;</span>
<span class="s2">        &lt;/div&gt;</span>
<span class="s2">    &lt;/div&gt;</span>

<span class="s2">    &lt;div class=&quot;footer&quot;&gt;</span>
<span class="s2">        Generado el </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/%m/%Y %H:%M:%S&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> | Code Empathizer v2.0</span>
<span class="s2">    &lt;/div&gt;</span>

<span class="s2">    &lt;script&gt;</span>
<span class="s2">        const ctx = document.getElementById(&#39;doughnutChart&#39;).getContext(&#39;2d&#39;);</span>

<span class="s2">        // Calcular rangos de puntuaciones</span>
<span class="s2">        const categorias = [&#39;nombres&#39;, &#39;documentacion&#39;, &#39;modularidad&#39;, &#39;complejidad&#39;, &#39;manejo_errores&#39;, &#39;pruebas&#39;, &#39;seguridad&#39;, &#39;consistencia_estilo&#39;];</span>
<span class="s2">        const scores = [];</span>

<span class="s2">        categorias.forEach(cat =&gt; </span><span class="se">{{</span>
<span class="s2">            const empScore = </span><span class="si">{</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">empresa_data</span><span class="p">)</span><span class="si">}</span><span class="s2">.get(cat, </span><span class="se">{{}}</span><span class="s2">).score || 0;</span>
<span class="s2">            const candScore = </span><span class="si">{</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">candidato_data</span><span class="p">)</span><span class="si">}</span><span class="s2">.get(cat, </span><span class="se">{{}}</span><span class="s2">).score || 0;</span>
<span class="s2">            scores.push(empScore * 100);</span>
<span class="s2">            scores.push(candScore * 100);</span>
<span class="s2">        </span><span class="se">}}</span><span class="s2">);</span>

<span class="s2">        let excelente = 0, bueno = 0, aceptable = 0, mejorar = 0;</span>
<span class="s2">        scores.forEach(score =&gt; </span><span class="se">{{</span>
<span class="s2">            if (score &gt;= 80) excelente++;</span>
<span class="s2">            else if (score &gt;= 60) bueno++;</span>
<span class="s2">            else if (score &gt;= 40) aceptable++;</span>
<span class="s2">            else mejorar++;</span>
<span class="s2">        </span><span class="se">}}</span><span class="s2">);</span>

<span class="s2">        new Chart(ctx, </span><span class="se">{{</span>
<span class="s2">            type: &#39;doughnut&#39;,</span>
<span class="s2">            data: </span><span class="se">{{</span>
<span class="s2">                labels: [&#39;Excelente (80-100%)&#39;, &#39;Bueno (60-79%)&#39;, &#39;Aceptable (40-59%)&#39;, &#39;Necesita Mejorar (&lt;40%)&#39;],</span>
<span class="s2">                datasets: [</span><span class="se">{{</span>
<span class="s2">                    data: [excelente, bueno, aceptable, mejorar],</span>
<span class="s2">                    backgroundColor: [</span>
<span class="s2">                        &#39;rgba(75, 192, 192, 0.8)&#39;,</span>
<span class="s2">                        &#39;rgba(54, 162, 235, 0.8)&#39;,</span>
<span class="s2">                        &#39;rgba(255, 206, 86, 0.8)&#39;,</span>
<span class="s2">                        &#39;rgba(255, 99, 132, 0.8)&#39;</span>
<span class="s2">                    ],</span>
<span class="s2">                    borderColor: [</span>
<span class="s2">                        &#39;rgba(75, 192, 192, 1)&#39;,</span>
<span class="s2">                        &#39;rgba(54, 162, 235, 1)&#39;,</span>
<span class="s2">                        &#39;rgba(255, 206, 86, 1)&#39;,</span>
<span class="s2">                        &#39;rgba(255, 99, 132, 1)&#39;</span>
<span class="s2">                    ],</span>
<span class="s2">                    borderWidth: 2</span>
<span class="s2">                </span><span class="se">}}</span><span class="s2">]</span>
<span class="s2">            </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">            options: </span><span class="se">{{</span>
<span class="s2">                responsive: true,</span>
<span class="s2">                maintainAspectRatio: false,</span>
<span class="s2">                plugins: </span><span class="se">{{</span>
<span class="s2">                    legend: </span><span class="se">{{</span>
<span class="s2">                        position: &#39;bottom&#39;,</span>
<span class="s2">                        labels: </span><span class="se">{{</span>
<span class="s2">                            padding: 15,</span>
<span class="s2">                            font: </span><span class="se">{{</span><span class="s2"> size: 13 </span><span class="se">}}</span>
<span class="s2">                        </span><span class="se">}}</span>
<span class="s2">                    </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                    tooltip: </span><span class="se">{{</span>
<span class="s2">                        backgroundColor: &#39;rgba(0, 0, 0, 0.8)&#39;,</span>
<span class="s2">                        titleFont: </span><span class="se">{{</span><span class="s2"> size: 14 </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                        bodyFont: </span><span class="se">{{</span><span class="s2"> size: 13 </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                        padding: 12,</span>
<span class="s2">                        callbacks: </span><span class="se">{{</span>
<span class="s2">                            label: function(context) </span><span class="se">{{</span>
<span class="s2">                                const total = context.dataset.data.reduce((a, b) =&gt; a + b, 0);</span>
<span class="s2">                                const percentage = ((context.parsed / total) * 100).toFixed(1);</span>
<span class="s2">                                return context.label + &#39;: &#39; + context.parsed + &#39; (&#39; + percentage + &#39;%)&#39;;</span>
<span class="s2">                            </span><span class="se">}}</span>
<span class="s2">                        </span><span class="se">}}</span>
<span class="s2">                    </span><span class="se">}}</span>
<span class="s2">                </span><span class="se">}}</span>
<span class="s2">            </span><span class="se">}}</span>
<span class="s2">        </span><span class="se">}}</span><span class="s2">);</span>
<span class="s2">    &lt;/script&gt;</span>
<span class="s2">&lt;/body&gt;</span>
<span class="s2">&lt;/html&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_generar_grafica_equipo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metricas</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">timestamp</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Genera HTML con gráfica comparativa de equipo.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s1">&#39;candidatos&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">metricas</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span>

        <span class="n">candidatos</span> <span class="o">=</span> <span class="n">metricas</span><span class="p">[</span><span class="s1">&#39;candidatos&#39;</span><span class="p">]</span>
        <span class="n">nombres</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">candidatos</span><span class="o">.</span><span class="n">keys</span><span class="p">())[:</span><span class="mi">10</span><span class="p">]</span>  <span class="c1"># Máximo 10 candidatos para claridad</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">candidatos</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;empathy_score&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nombres</span><span class="p">]</span>

        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;&lt;!DOCTYPE html&gt;</span>
<span class="s2">&lt;html lang=&quot;es&quot;&gt;</span>
<span class="s2">&lt;head&gt;</span>
<span class="s2">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span>
<span class="s2">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span>
<span class="s2">    &lt;title&gt;COMPARATIVA DE EQUIPO&lt;/title&gt;</span>
<span class="s2">    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js&quot;&gt;&lt;/script&gt;</span>
<span class="s2">    &lt;style&gt;</span>
<span class="s2">        * </span><span class="se">{{</span>
<span class="s2">            margin: 0;</span>
<span class="s2">            padding: 0;</span>
<span class="s2">            box-sizing: border-box;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        body </span><span class="se">{{</span>
<span class="s2">            font-family: &#39;Segoe UI&#39;, Tahoma, Geneva, Verdana, sans-serif;</span>
<span class="s2">            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);</span>
<span class="s2">            min-height: 100vh;</span>
<span class="s2">            display: flex;</span>
<span class="s2">            flex-direction: column;</span>
<span class="s2">            align-items: center;</span>
<span class="s2">            padding: 20px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .container </span><span class="se">{{</span>
<span class="s2">            background: white;</span>
<span class="s2">            border-radius: 20px;</span>
<span class="s2">            box-shadow: 0 20px 60px rgba(0,0,0,0.3);</span>
<span class="s2">            padding: 30px;</span>
<span class="s2">            max-width: 1200px;</span>
<span class="s2">            width: 100%;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        h1 </span><span class="se">{{</span>
<span class="s2">            color: #333;</span>
<span class="s2">            text-align: center;</span>
<span class="s2">            margin-bottom: 10px;</span>
<span class="s2">            font-size: 28px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .subtitle </span><span class="se">{{</span>
<span class="s2">            text-align: center;</span>
<span class="s2">            color: #666;</span>
<span class="s2">            margin-bottom: 30px;</span>
<span class="s2">            font-size: 14px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .chart-container </span><span class="se">{{</span>
<span class="s2">            position: relative;</span>
<span class="s2">            height: 500px;</span>
<span class="s2">            margin: 20px 0;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .footer </span><span class="se">{{</span>
<span class="s2">            text-align: center;</span>
<span class="s2">            color: #333;</span>
<span class="s2">            margin-top: 20px;</span>
<span class="s2">            font-size: 12px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">    &lt;/style&gt;</span>
<span class="s2">&lt;/head&gt;</span>
<span class="s2">&lt;body&gt;</span>
<span class="s2">    &lt;div class=&quot;container&quot;&gt;</span>
<span class="s2">        &lt;h1&gt;COMPARATIVA DE CANDIDATOS&lt;/h1&gt;</span>
<span class="s2">        &lt;p class=&quot;subtitle&quot;&gt;RANKING POR SCORE DE EMPATÍA&lt;/p&gt;</span>

<span class="s2">        &lt;div class=&quot;chart-container&quot;&gt;</span>
<span class="s2">            &lt;canvas id=&quot;teamChart&quot;&gt;&lt;/canvas&gt;</span>
<span class="s2">        &lt;/div&gt;</span>
<span class="s2">    &lt;/div&gt;</span>

<span class="s2">    &lt;div class=&quot;footer&quot;&gt;</span>
<span class="s2">        Generado el </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/%m/%Y %H:%M:%S&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> | Code Empathizer v2.0</span>
<span class="s2">    &lt;/div&gt;</span>

<span class="s2">    &lt;script&gt;</span>
<span class="s2">        const ctx = document.getElementById(&#39;teamChart&#39;).getContext(&#39;2d&#39;);</span>

<span class="s2">        const scores = </span><span class="si">{</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span><span class="si">}</span><span class="s2">;</span>
<span class="s2">        const backgroundColors = scores.map(score =&gt; </span><span class="se">{{</span>
<span class="s2">            if (score &gt;= 80) return &#39;rgba(75, 192, 192, 0.8)&#39;;</span>
<span class="s2">            if (score &gt;= 60) return &#39;rgba(54, 162, 235, 0.8)&#39;;</span>
<span class="s2">            if (score &gt;= 40) return &#39;rgba(255, 206, 86, 0.8)&#39;;</span>
<span class="s2">            return &#39;rgba(255, 99, 132, 0.8)&#39;;</span>
<span class="s2">        </span><span class="se">}}</span><span class="s2">);</span>

<span class="s2">        new Chart(ctx, </span><span class="se">{{</span>
<span class="s2">            type: &#39;bar&#39;,</span>
<span class="s2">            data: </span><span class="se">{{</span>
<span class="s2">                labels: </span><span class="si">{</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">nombres</span><span class="p">)</span><span class="si">}</span><span class="s2">,</span>
<span class="s2">                datasets: [</span><span class="se">{{</span>
<span class="s2">                    label: &#39;Score de Empatía (%)&#39;,</span>
<span class="s2">                    data: scores,</span>
<span class="s2">                    backgroundColor: backgroundColors,</span>
<span class="s2">                    borderColor: backgroundColors.map(c =&gt; c.replace(&#39;0.8&#39;, &#39;1&#39;)),</span>
<span class="s2">                    borderWidth: 2,</span>
<span class="s2">                    borderRadius: 5</span>
<span class="s2">                </span><span class="se">}}</span><span class="s2">]</span>
<span class="s2">            </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">            options: </span><span class="se">{{</span>
<span class="s2">                indexAxis: &#39;y&#39;,</span>
<span class="s2">                responsive: true,</span>
<span class="s2">                maintainAspectRatio: false,</span>
<span class="s2">                plugins: </span><span class="se">{{</span>
<span class="s2">                    legend: </span><span class="se">{{</span>
<span class="s2">                        display: false</span>
<span class="s2">                    </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                    tooltip: </span><span class="se">{{</span>
<span class="s2">                        backgroundColor: &#39;rgba(0, 0, 0, 0.8)&#39;,</span>
<span class="s2">                        titleFont: </span><span class="se">{{</span><span class="s2"> size: 14 </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                        bodyFont: </span><span class="se">{{</span><span class="s2"> size: 13 </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                        padding: 12,</span>
<span class="s2">                        callbacks: </span><span class="se">{{</span>
<span class="s2">                            label: function(context) </span><span class="se">{{</span>
<span class="s2">                                let label = &#39;Score: &#39; + context.parsed.x.toFixed(2) + &#39;%&#39;;</span>
<span class="s2">                                if (context.parsed.x &gt;= 80) label += &#39; (Excelente)&#39;;</span>
<span class="s2">                                else if (context.parsed.x &gt;= 60) label += &#39; (Bueno)&#39;;</span>
<span class="s2">                                else if (context.parsed.x &gt;= 40) label += &#39; (Aceptable)&#39;;</span>
<span class="s2">                                else label += &#39; (Necesita mejorar)&#39;;</span>
<span class="s2">                                return label;</span>
<span class="s2">                            </span><span class="se">}}</span>
<span class="s2">                        </span><span class="se">}}</span>
<span class="s2">                    </span><span class="se">}}</span>
<span class="s2">                </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                scales: </span><span class="se">{{</span>
<span class="s2">                    x: </span><span class="se">{{</span>
<span class="s2">                        beginAtZero: true,</span>
<span class="s2">                        max: 100,</span>
<span class="s2">                        ticks: </span><span class="se">{{</span>
<span class="s2">                            callback: function(value) </span><span class="se">{{</span>
<span class="s2">                                return value + &#39;%&#39;;</span>
<span class="s2">                            </span><span class="se">}}</span>
<span class="s2">                        </span><span class="se">}}</span>
<span class="s2">                    </span><span class="se">}}</span>
<span class="s2">                </span><span class="se">}}</span>
<span class="s2">            </span><span class="se">}}</span>
<span class="s2">        </span><span class="se">}}</span><span class="s2">);</span>
<span class="s2">    &lt;/script&gt;</span>
<span class="s2">&lt;/body&gt;</span>
<span class="s2">&lt;/html&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_generar_grafica_heatmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metricas</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">timestamp</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Genera HTML con mapa de calor comparativo.&quot;&quot;&quot;</span>
        <span class="n">empresa_data</span> <span class="o">=</span> <span class="n">metricas</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;repos&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;empresa&#39;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">candidato_data</span> <span class="o">=</span> <span class="n">metricas</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;repos&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;candidato&#39;</span><span class="p">,</span> <span class="p">{})</span>

        <span class="n">categorias</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s1">&#39;nombres&#39;</span><span class="p">,</span> <span class="s1">&#39;NOMBRES&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;documentacion&#39;</span><span class="p">,</span> <span class="s1">&#39;DOCUMENTACIÓN&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;modularidad&#39;</span><span class="p">,</span> <span class="s1">&#39;MODULARIDAD&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;complejidad&#39;</span><span class="p">,</span> <span class="s1">&#39;COMPLEJIDAD&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;manejo_errores&#39;</span><span class="p">,</span> <span class="s1">&#39;MANEJO ERRORES&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;pruebas&#39;</span><span class="p">,</span> <span class="s1">&#39;PRUEBAS&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;seguridad&#39;</span><span class="p">,</span> <span class="s1">&#39;SEGURIDAD&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;consistencia_estilo&#39;</span><span class="p">,</span> <span class="s1">&#39;CONSISTENCIA&#39;</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">get_color</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Retorna color según el valor.&quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">90</span><span class="p">:</span> <span class="k">return</span> <span class="s1">&#39;#2ecc71&#39;</span>  <span class="c1"># Verde oscuro</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">75</span><span class="p">:</span> <span class="k">return</span> <span class="s1">&#39;#58d68d&#39;</span>  <span class="c1"># Verde claro</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">60</span><span class="p">:</span> <span class="k">return</span> <span class="s1">&#39;#f39c12&#39;</span>  <span class="c1"># Amarillo</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">45</span><span class="p">:</span> <span class="k">return</span> <span class="s1">&#39;#e67e22&#39;</span>  <span class="c1"># Naranja</span>
            <span class="k">return</span> <span class="s1">&#39;#e74c3c&#39;</span>  <span class="c1"># Rojo</span>

        <span class="n">filas_html</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">cat_key</span><span class="p">,</span> <span class="n">cat_label</span> <span class="ow">in</span> <span class="n">categorias</span><span class="p">:</span>
            <span class="n">emp_score</span> <span class="o">=</span> <span class="n">empresa_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cat_key</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;score&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">cand_score</span> <span class="o">=</span> <span class="n">candidato_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cat_key</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;score&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">emp_pct</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">emp_score</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">emp_score</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="n">cand_pct</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">cand_score</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">cand_score</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="n">diferencia</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">emp_pct</span> <span class="o">-</span> <span class="n">cand_pct</span><span class="p">)</span>

            <span class="n">filas_html</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            &lt;tr&gt;</span>
<span class="s2">                &lt;td class=&quot;category-label&quot;&gt;</span><span class="si">{</span><span class="n">cat_label</span><span class="si">}</span><span class="s2">&lt;/td&gt;</span>
<span class="s2">                &lt;td style=&quot;background-color: </span><span class="si">{</span><span class="n">get_color</span><span class="p">(</span><span class="n">emp_pct</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot; title=&quot;Empresa: </span><span class="si">{</span><span class="n">emp_pct</span><span class="si">}</span><span class="s2">%&quot;&gt;</span><span class="si">{</span><span class="n">emp_pct</span><span class="si">}</span><span class="s2">%&lt;/td&gt;</span>
<span class="s2">                &lt;td style=&quot;background-color: </span><span class="si">{</span><span class="n">get_color</span><span class="p">(</span><span class="n">cand_pct</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot; title=&quot;Candidato: </span><span class="si">{</span><span class="n">cand_pct</span><span class="si">}</span><span class="s2">%&quot;&gt;</span><span class="si">{</span><span class="n">cand_pct</span><span class="si">}</span><span class="s2">%&lt;/td&gt;</span>
<span class="s2">                &lt;td class=&quot;diff-column&quot; title=&quot;Diferencia absoluta&quot;&gt;</span><span class="si">{</span><span class="n">diferencia</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&lt;/td&gt;</span>
<span class="s2">            &lt;/tr&gt;</span>
<span class="s2">            &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;&lt;!DOCTYPE html&gt;</span>
<span class="s2">&lt;html lang=&quot;es&quot;&gt;</span>
<span class="s2">&lt;head&gt;</span>
<span class="s2">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span>
<span class="s2">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span>
<span class="s2">    &lt;title&gt;MAPA DE CALOR - ANÁLISIS DE EMPATÍA&lt;/title&gt;</span>
<span class="s2">    &lt;style&gt;</span>
<span class="s2">        * </span><span class="se">{{</span>
<span class="s2">            margin: 0;</span>
<span class="s2">            padding: 0;</span>
<span class="s2">            box-sizing: border-box;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        body </span><span class="se">{{</span>
<span class="s2">            font-family: &#39;Segoe UI&#39;, Tahoma, Geneva, Verdana, sans-serif;</span>
<span class="s2">            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);</span>
<span class="s2">            min-height: 100vh;</span>
<span class="s2">            display: flex;</span>
<span class="s2">            flex-direction: column;</span>
<span class="s2">            align-items: center;</span>
<span class="s2">            padding: 20px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .container </span><span class="se">{{</span>
<span class="s2">            background: white;</span>
<span class="s2">            border-radius: 20px;</span>
<span class="s2">            box-shadow: 0 20px 60px rgba(0,0,0,0.3);</span>
<span class="s2">            padding: 30px;</span>
<span class="s2">            max-width: 900px;</span>
<span class="s2">            width: 100%;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        h1 </span><span class="se">{{</span>
<span class="s2">            color: #333;</span>
<span class="s2">            text-align: center;</span>
<span class="s2">            margin-bottom: 10px;</span>
<span class="s2">            font-size: 28px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .subtitle </span><span class="se">{{</span>
<span class="s2">            text-align: center;</span>
<span class="s2">            color: #666;</span>
<span class="s2">            margin-bottom: 30px;</span>
<span class="s2">            font-size: 14px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .heatmap-container </span><span class="se">{{</span>
<span class="s2">            overflow-x: auto;</span>
<span class="s2">            margin: 20px 0;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .heatmap-table </span><span class="se">{{</span>
<span class="s2">            width: 100%;</span>
<span class="s2">            border-collapse: separate;</span>
<span class="s2">            border-spacing: 2px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .heatmap-table th </span><span class="se">{{</span>
<span class="s2">            background: #34495e;</span>
<span class="s2">            color: white;</span>
<span class="s2">            padding: 15px;</span>
<span class="s2">            font-weight: 600;</span>
<span class="s2">            text-align: center;</span>
<span class="s2">            font-size: 14px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .heatmap-table td </span><span class="se">{{</span>
<span class="s2">            padding: 18px;</span>
<span class="s2">            text-align: center;</span>
<span class="s2">            font-size: 16px;</span>
<span class="s2">            font-weight: 600;</span>
<span class="s2">            color: white;</span>
<span class="s2">            border-radius: 4px;</span>
<span class="s2">            transition: all 0.3s ease;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .heatmap-table td:not(.category-label):not(.diff-column):hover </span><span class="se">{{</span>
<span class="s2">            transform: scale(1.08);</span>
<span class="s2">            box-shadow: 0 6px 12px rgba(0,0,0,0.4);</span>
<span class="s2">            z-index: 10;</span>
<span class="s2">            position: relative;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .category-label </span><span class="se">{{</span>
<span class="s2">            background: #ecf0f1;</span>
<span class="s2">            color: #2c3e50;</span>
<span class="s2">            font-weight: 600;</span>
<span class="s2">            text-align: left;</span>
<span class="s2">            padding-left: 20px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .diff-column </span><span class="se">{{</span>
<span class="s2">            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);</span>
<span class="s2">            font-weight: bold;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .legend </span><span class="se">{{</span>
<span class="s2">            display: flex;</span>
<span class="s2">            justify-content: center;</span>
<span class="s2">            gap: 20px;</span>
<span class="s2">            margin-top: 30px;</span>
<span class="s2">            flex-wrap: wrap;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .legend-item </span><span class="se">{{</span>
<span class="s2">            display: flex;</span>
<span class="s2">            align-items: center;</span>
<span class="s2">            gap: 8px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .legend-color </span><span class="se">{{</span>
<span class="s2">            width: 30px;</span>
<span class="s2">            height: 20px;</span>
<span class="s2">            border-radius: 4px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .legend-label </span><span class="se">{{</span>
<span class="s2">            font-size: 13px;</span>
<span class="s2">            color: #666;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .info </span><span class="se">{{</span>
<span class="s2">            background: #f8f9fa;</span>
<span class="s2">            padding: 20px;</span>
<span class="s2">            border-radius: 10px;</span>
<span class="s2">            margin-top: 20px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .info h3 </span><span class="se">{{</span>
<span class="s2">            color: #2c3e50;</span>
<span class="s2">            margin-bottom: 10px;</span>
<span class="s2">            font-size: 16px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .info p </span><span class="se">{{</span>
<span class="s2">            color: #555;</span>
<span class="s2">            line-height: 1.6;</span>
<span class="s2">            font-size: 14px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        .footer </span><span class="se">{{</span>
<span class="s2">            text-align: center;</span>
<span class="s2">            color: white;</span>
<span class="s2">            margin-top: 20px;</span>
<span class="s2">            font-size: 12px;</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        @media (max-width: 768px) </span><span class="se">{{</span>
<span class="s2">            .heatmap-table th, .heatmap-table td </span><span class="se">{{</span>
<span class="s2">                padding: 10px 5px;</span>
<span class="s2">                font-size: 12px;</span>
<span class="s2">            </span><span class="se">}}</span>
<span class="s2">            h1 </span><span class="se">{{</span>
<span class="s2">                font-size: 22px;</span>
<span class="s2">            </span><span class="se">}}</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">    &lt;/style&gt;</span>
<span class="s2">&lt;/head&gt;</span>
<span class="s2">&lt;body&gt;</span>
<span class="s2">    &lt;div class=&quot;container&quot;&gt;</span>
<span class="s2">        &lt;h1&gt;MAPA DE CALOR - ANÁLISIS DE EMPATÍA&lt;/h1&gt;</span>
<span class="s2">        &lt;p class=&quot;subtitle&quot;&gt;COMPARACIÓN VISUAL DE TODAS LAS CATEGORÍAS&lt;/p&gt;</span>

<span class="s2">        &lt;div class=&quot;heatmap-container&quot;&gt;</span>
<span class="s2">            &lt;table class=&quot;heatmap-table&quot;&gt;</span>
<span class="s2">                &lt;thead&gt;</span>
<span class="s2">                    &lt;tr&gt;</span>
<span class="s2">                        &lt;th&gt;CATEGORÍA&lt;/th&gt;</span>
<span class="s2">                        &lt;th&gt;EMPRESA&lt;/th&gt;</span>
<span class="s2">                        &lt;th&gt;CANDIDATO&lt;/th&gt;</span>
<span class="s2">                        &lt;th&gt;DIFERENCIA&lt;/th&gt;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                &lt;/thead&gt;</span>
<span class="s2">                &lt;tbody&gt;</span>
<span class="s2">                    </span><span class="si">{</span><span class="n">filas_html</span><span class="si">}</span>
<span class="s2">                &lt;/tbody&gt;</span>
<span class="s2">            &lt;/table&gt;</span>
<span class="s2">        &lt;/div&gt;</span>

<span class="s2">        &lt;div class=&quot;legend&quot;&gt;</span>
<span class="s2">            &lt;div class=&quot;legend-item&quot;&gt;</span>
<span class="s2">                &lt;div class=&quot;legend-color&quot; style=&quot;background: #2ecc71&quot;&gt;&lt;/div&gt;</span>
<span class="s2">                &lt;span class=&quot;legend-label&quot;&gt;Excelente (90-100%)&lt;/span&gt;</span>
<span class="s2">            &lt;/div&gt;</span>
<span class="s2">            &lt;div class=&quot;legend-item&quot;&gt;</span>
<span class="s2">                &lt;div class=&quot;legend-color&quot; style=&quot;background: #58d68d&quot;&gt;&lt;/div&gt;</span>
<span class="s2">                &lt;span class=&quot;legend-label&quot;&gt;Bueno (75-89%)&lt;/span&gt;</span>
<span class="s2">            &lt;/div&gt;</span>
<span class="s2">            &lt;div class=&quot;legend-item&quot;&gt;</span>
<span class="s2">                &lt;div class=&quot;legend-color&quot; style=&quot;background: #f39c12&quot;&gt;&lt;/div&gt;</span>
<span class="s2">                &lt;span class=&quot;legend-label&quot;&gt;Aceptable (60-74%)&lt;/span&gt;</span>
<span class="s2">            &lt;/div&gt;</span>
<span class="s2">            &lt;div class=&quot;legend-item&quot;&gt;</span>
<span class="s2">                &lt;div class=&quot;legend-color&quot; style=&quot;background: #e67e22&quot;&gt;&lt;/div&gt;</span>
<span class="s2">                &lt;span class=&quot;legend-label&quot;&gt;Regular (45-59%)&lt;/span&gt;</span>
<span class="s2">            &lt;/div&gt;</span>
<span class="s2">            &lt;div class=&quot;legend-item&quot;&gt;</span>
<span class="s2">                &lt;div class=&quot;legend-color&quot; style=&quot;background: #e74c3c&quot;&gt;&lt;/div&gt;</span>
<span class="s2">                &lt;span class=&quot;legend-label&quot;&gt;Deficiente (0-44%)&lt;/span&gt;</span>
<span class="s2">            &lt;/div&gt;</span>
<span class="s2">        &lt;/div&gt;</span>

<span class="s2">        &lt;div class=&quot;info&quot;&gt;</span>
<span class="s2">            &lt;h3&gt;Cómo interpretar este mapa de calor&lt;/h3&gt;</span>
<span class="s2">            &lt;p&gt;</span>
<span class="s2">                Este mapa de calor muestra visualmente el rendimiento en cada categoría de análisis.</span>
<span class="s2">                Los colores más verdes indican mejor calidad de código, mientras que los rojos señalan</span>
<span class="s2">                áreas que requieren mejora. La columna &quot;Diferencia&quot; muestra la brecha entre empresa</span>
<span class="s2">                y candidato, siendo útil para identificar las áreas prioritarias de capacitación.</span>
<span class="s2">                &lt;br&gt;&lt;br&gt;</span>
<span class="s2">                &lt;strong&gt;Tip:&lt;/strong&gt; Pasa el cursor sobre cada celda para ver detalles adicionales.</span>
<span class="s2">            &lt;/p&gt;</span>
<span class="s2">        &lt;/div&gt;</span>
<span class="s2">    &lt;/div&gt;</span>

<span class="s2">    &lt;div class=&quot;footer&quot;&gt;</span>
<span class="s2">        Generado el </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/%m/%Y %H:%M:%S&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> | Code Empathizer v2.0</span>
<span class="s2">    &lt;/div&gt;</span>
<span class="s2">&lt;/body&gt;</span>
<span class="s2">&lt;/html&gt;</span>
<span class="s2">&quot;&quot;&quot;</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>© 2025 <a href="https://github.com/686f6c61">https://github.com/686f6c61</a> - Licencia MIT</p>
  </div>

  Compilado con <a href="https://www.sphinx-doc.org/">Sphinx</a> usando un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">tema</a>
    proporcionado por <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>